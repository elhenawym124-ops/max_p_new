# โค๏ธ ูุงุฆูุฉ ุงูุฑุบุจุงุช (Wishlist) - ุฏููู ุดุงูู

**ุชุงุฑูุฎ ุงูุชูุซูู:** $(Get-Date -Format "yyyy-MM-dd HH:mm:ss")

---

## ๐ ูุง ูู ูุงุฆูุฉ ุงูุฑุบุจุงุชุ

ูุงุฆูุฉ ุงูุฑุบุจุงุช (Wishlist) ูู ููุฒุฉ ุชุณูุญ ููุนููุงุก ุจุญูุธ ุงูููุชุฌุงุช ุงูุชู ูุฑูุฏูู ุดุฑุงุกูุง ูุงุญูุงู. ุชุนูู ูุซู "ุงูููุถูุฉ" ุญูุซ ูููู ููุนููุงุก:

- โ ุฅุถุงูุฉ ููุชุฌุงุช ููููุถูุฉ
- โ ุญุฐู ููุชุฌุงุช ูู ุงูููุถูุฉ
- โ ุนุฑุถ ุฌููุน ุงูููุชุฌุงุช ุงูููุถูุฉ ูู ุตูุญุฉ ูุงุญุฏุฉ
- โ ุฅุถุงูุฉ ุงูููุชุฌุงุช ุงูููุถูุฉ ููุณูุฉ ูุจุงุดุฑุฉ
- โ ูุณุญ ูุงุฆูุฉ ุงูุฑุบุจุงุช ุจุงููุงูู

---

## ๐ง ููู ุชุนููุ

### 1. **Backend (ูุงุนุฏุฉ ุงูุจูุงูุงุช)**

#### ูููุฐุฌ ุงูุจูุงูุงุช (Prisma Schema):
```prisma
model Wishlist {
  id          String   @id @default(cuid())
  sessionId   String   // ูุนุฑู ุงูุฌูุณุฉ ููุนููุงุก ุบูุฑ ุงููุณุฌููู
  customerId  String?  // ูุนุฑู ุงูุนููู (ุฅุฐุง ูุงู ูุณุฌู)
  productId   String   // ูุนุฑู ุงูููุชุฌ
  variantId   String?  // ูุนุฑู ุงููุชุบูุฑ (ุฅุฐุง ูุงู ุงูููุชุฌ ูู variants)
  companyId   String   // ูุนุฑู ุงูุดุฑูุฉ
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  
  product     Product  @relation(...)
  company     Company  @relation(...)
  
  @@unique([sessionId, productId, variantId, companyId])
  @@index([sessionId])
  @@index([customerId])
}
```

**ุงููููุฒุงุช:**
- โ ูุฏุนู ุงูุนููุงุก ุงููุณุฌููู ูุบูุฑ ุงููุณุฌููู
- โ ูุฏุนู ุงูููุชุฌุงุช ูุน variants
- โ ูุฑูุฏ ููู ุดุฑูุฉ (companyId)
- โ ููุน ุงูุชูุฑุงุฑ (unique constraint)

---

### 2. **Frontend (ูุงุฌูุฉ ุงููุณุชุฎุฏู)**

#### ุฃ) **WishlistButton Component** (`components/storefront/WishlistButton.tsx`)

**ุงููุธููุฉ:** ุฒุฑ ูุฅุถุงูุฉ/ุญุฐู ููุชุฌ ูู ุงูููุถูุฉ

**ุงููููุฒุงุช:**
- โ ูุชุญูู ุชููุงุฆูุงู ูู ุญุงูุฉ ุงูููุชุฌ (ููุฌูุฏ ูู ุงูููุถูุฉ ุฃู ูุง)
- โ ุฃููููุฉ ููุจ ูุงุฑุบุฉ/ููููุกุฉ ุญุณุจ ุงูุญุงูุฉ
- โ Toast notifications ุนูุฏ ุงูุฅุถุงูุฉ/ุงูุญุฐู
- โ Loading state ุฃุซูุงุก ุงููุนุงูุฌุฉ
- โ 3 ุฃุญุฌุงู: `sm`, `md`, `lg`
- โ ูุนูู ูุน variants

**ุงูุงุณุชุฎุฏุงู:**
```tsx
<WishlistButton
  productId={product.id}
  variantId={selectedVariant}
  enabled={storefrontSettings?.wishlistEnabled}
  size="lg"
/>
```

---

#### ุจ) **WishlistPage Component** (`pages/storefront/WishlistPage.tsx`)

**ุงููุธููุฉ:** ุตูุญุฉ ูุนุฑุถ ุฌููุน ุงูููุชุฌุงุช ุงูููุถูุฉ

**ุงููููุฒุงุช:**
- โ ุนุฑุถ ุฌููุน ุงูููุชุฌุงุช ูู grid layout
- โ ุฅุถุงูุฉ ููุชุฌ ููุณูุฉ ูุจุงุดุฑุฉ
- โ ุญุฐู ููุชุฌ ูู ุงูููุถูุฉ
- โ ูุณุญ ุงููุงุฆูุฉ ุจุงููุงูู
- โ ุฑุณุงูุฉ ุนูุฏ ุนุฏู ูุฌูุฏ ููุชุฌุงุช
- โ Loading state
- โ Responsive design

**ุงููุธุงุฆู:**
- `fetchWishlist()` - ุฌูุจ ูุงุฆูุฉ ุงูุฑุบุจุงุช
- `handleRemove()` - ุญุฐู ููุชุฌ
- `handleAddToCart()` - ุฅุถุงูุฉ ููุณูุฉ
- `handleClearAll()` - ูุณุญ ุงููู

---

#### ุฌ) **Wishlist API** (`utils/wishlistApi.ts`)

**ุงููุธุงุฆู ุงููุชุงุญุฉ:**

1. **`getWishlist()`** - ุฌูุจ ูุงุฆูุฉ ุงูุฑุบุจุงุช
   ```typescript
   const data = await wishlistApi.getWishlist();
   // Returns: { success: true, data: { items: [...] } }
   ```

2. **`addToWishlist(productId, variantId?)`** - ุฅุถุงูุฉ ููุชุฌ
   ```typescript
   await wishlistApi.addToWishlist(productId, variantId);
   ```

3. **`removeFromWishlist(productId, variantId?)`** - ุญุฐู ููุชุฌ
   ```typescript
   await wishlistApi.removeFromWishlist(productId, variantId);
   ```

4. **`getWishlistCount()`** - ุฌูุจ ุนุฏุฏ ุงูููุชุฌุงุช
   ```typescript
   const data = await wishlistApi.getWishlistCount();
   // Returns: { success: true, data: { count: 5 } }
   ```

5. **`clearWishlist()`** - ูุณุญ ุงููุงุฆูุฉ ุจุงููุงูู
   ```typescript
   await wishlistApi.clearWishlist();
   ```

**Session Management:**
- ูุณุชุฎุฏู `localStorage.getItem('wishlist_session_id')`
- ููุดุฆ session ID ุชููุงุฆูุงู ุฅุฐุง ูู ููู ููุฌูุฏุงู
- ูุฑุณู `x-session-id` header ูู ุฌููุน ุงูุทูุจุงุช

---

### 3. **Backend API Routes**

**ุงููุณุงุฑุงุช ุงููุชุงุญุฉ:**

- `GET /api/v1/public/wishlist` - ุฌูุจ ูุงุฆูุฉ ุงูุฑุบุจุงุช
- `POST /api/v1/public/wishlist` - ุฅุถุงูุฉ ููุชุฌ
- `DELETE /api/v1/public/wishlist/:productId` - ุญุฐู ููุชุฌ
- `GET /api/v1/public/wishlist/count` - ุฌูุจ ุงูุนุฏุฏ
- `DELETE /api/v1/public/wishlist/clear` - ูุณุญ ุงููู

**ุงููุนุงููุงุช:**
- `companyId` - ูุนุฑู ุงูุดุฑูุฉ (ูุทููุจ)
- `sessionId` - ูุนุฑู ุงูุฌูุณุฉ (ูู header `x-session-id`)
- `variantId` - ูุนุฑู ุงููุชุบูุฑ (ุงุฎุชูุงุฑู)

---

## โ ูู ูู ูุงููุฉุ

### ุงููููุฒุงุช ุงููุทุจูุฉ:

1. โ **ุฅุถุงูุฉ/ุญุฐู ููุชุฌุงุช** - ูุนูู ุจุดูู ูุงูู
2. โ **ุนุฑุถ ูุงุฆูุฉ ุงูุฑุบุจุงุช** - ุตูุญุฉ ูุงููุฉ ูุน ุชุตููู ุฌููู
3. โ **ุฅุถุงูุฉ ููุณูุฉ ูู ุงูููุถูุฉ** - ูุนูู ูุจุงุดุฑุฉ
4. โ **Session Management** - ููุนููุงุก ุบูุฑ ุงููุณุฌููู
5. โ **Support for Variants** - ูุฏุนู ุงูููุชุฌุงุช ูุน variants
6. โ **Toast Notifications** - ุฑุณุงุฆู ูุงุถุญุฉ
7. โ **Loading States** - ุญุงูุงุช ุชุญููู
8. โ **Responsive Design** - ูุนูู ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ
9. โ **Settings Integration** - ูููู ุชูุนูู/ุชุนุทูู ูู ุงูุฅุนุฏุงุฏุงุช
10. โ **Event System** - `wishlistUpdated` event ููุชุญุฏูุซุงุช

---

### ุงููููุฒุงุช ุงูููููุฏุฉ/ุงููุญุชููุฉ:

1. โ๏ธ **Wishlist Count ูู Navigation** - ุบูุฑ ููุฌูุฏ ุญุงููุงู
   - ูููู ุฅุถุงูุชู ูู `StorefrontNav.tsx` ูุซู cart count

2. โ๏ธ **ูุดุงุฑูุฉ ูุงุฆูุฉ ุงูุฑุบุจุงุช** - ุบูุฑ ูุชุงุญุฉ
   - ูููู ุฅุถุงูุฉ ุฑุงุจุท ูุดุงุฑูุฉ

3. โ๏ธ **ุฅุดุนุงุฑุงุช ุนูุฏ ุงูุฎูุงุถ ุงูุณุนุฑ** - ุบูุฑ ูุชุงุญุฉ
   - ูููู ุฅุถุงูุฉ ููุฒุฉ Back in Stock notifications

4. โ๏ธ **ุชุตุฏูุฑ ูุงุฆูุฉ ุงูุฑุบุจุงุช** - ุบูุฑ ูุชุงุญุฉ
   - ูููู ุฅุถุงูุฉ ุชุตุฏูุฑ PDF ุฃู CSV

5. โ๏ธ **ูุฌููุนุงุช/ูุฆุงุช ูู ุงูููุถูุฉ** - ุบูุฑ ูุชุงุญุฉ
   - ูููู ุฅุถุงูุฉ ุชูุธูู ุงูููุชุฌุงุช ูู ูุฌููุนุงุช

---

## ๐ ุฃูู ูุชู ุงุณุชุฎุฏุงููุงุ

### 1. **ุตูุญุฉ ุชูุงุตูู ุงูููุชุฌ** (`ProductDetails.tsx`)
```tsx
{storefrontSettings?.wishlistEnabled && (
  <WishlistButton
    productId={product.id}
    variantId={selectedVariant || undefined}
    enabled={storefrontSettings.wishlistEnabled}
    size="lg"
  />
)}
```

### 2. **ุตูุญุฉ ุงูููุชุฌุงุช** (`Shop.tsx`)
- ูููู ุฅุถุงูุฉ `WishlistButton` ูู ุจุทุงูุงุช ุงูููุชุฌุงุช

### 3. **Quick View Modal** (`QuickViewModal.tsx`)
- ูุฏุนู `showWishlist` prop

### 4. **ุตูุญุฉ ุงูููุถูุฉ** (`WishlistPage.tsx`)
- `/shop/wishlist` - ุตูุญุฉ ูุงููุฉ ูุนุฑุถ ุงูููุถูุฉ

### 5. **Navigation** (`StorefrontNav.tsx`)
- ุฑุงุจุท "ุงูููุถูุฉ" ูู ุงููุงุฆูุฉ

---

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช

ูููู ุชูุนูู/ุชุนุทูู ุงูููุฒุฉ ูู:
- `/settings/storefront-features`
- `wishlistEnabled` ูู `StorefrontSettings`

---

## ๐ ุงูุฃูุงู

- โ ูู ุดุฑูุฉ ููุง ูุงุฆูุฉ ุฑุบุจุงุช ูููุตูุฉ (`companyId`)
- โ Session-based ููุนููุงุก ุบูุฑ ุงููุณุฌููู
- โ Customer-based ููุนููุงุก ุงููุณุฌููู
- โ ููุน ุงูุชูุฑุงุฑ (unique constraint)

---

## ๐ ููุฎุต ุงูุญุงูุฉ

| ุงูููุฒุฉ | ุงูุญุงูุฉ | ุงูููุงุญุธุงุช |
|--------|--------|-----------|
| ุฅุถุงูุฉ/ุญุฐู ููุชุฌุงุช | โ ูุงููุฉ | ูุนูู ุจุดูู ููุชุงุฒ |
| ุนุฑุถ ูุงุฆูุฉ ุงูุฑุบุจุงุช | โ ูุงููุฉ | ุตูุญุฉ ูุงููุฉ ูุน ุชุตููู ุฌููู |
| ุฅุถุงูุฉ ููุณูุฉ | โ ูุงููุฉ | ูุนูู ูุจุงุดุฑุฉ ูู ุงูููุถูุฉ |
| Session Management | โ ูุงููุฉ | ููุนููุงุก ุบูุฑ ุงููุณุฌููู |
| Variants Support | โ ูุงููุฉ | ูุฏุนู ุงูููุชุฌุงุช ูุน variants |
| Settings Integration | โ ูุงููุฉ | ูููู ุชูุนูู/ุชุนุทูู |
| Responsive Design | โ ูุงููุฉ | ูุนูู ุนูู ุฌููุน ุงูุฃุฌูุฒุฉ |
| Wishlist Count ูู Nav | โ๏ธ ุบูุฑ ููุฌูุฏ | ูููู ุฅุถุงูุชู |
| ูุดุงุฑูุฉ ุงููุงุฆูุฉ | โ ุบูุฑ ูุชุงุญุฉ | ููุฒุฉ ุฅุถุงููุฉ |
| ุฅุดุนุงุฑุงุช ุงูุณุนุฑ | โ ุบูุฑ ูุชุงุญุฉ | ููุฒุฉ ุฅุถุงููุฉ |

---

## ๐ฏ ุงูุฎูุงุตุฉ

**ูุงุฆูุฉ ุงูุฑุบุจุงุช ููุฒุฉ ูุงููุฉ ูุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู!** โ

- โ ุฌููุน ุงููุธุงุฆู ุงูุฃุณุงุณูุฉ ููุฌูุฏุฉ
- โ ุงูุชุตููู ุฌููู ููุชุฌุงูุจ
- โ ูุนูู ูุน ุงูุนููุงุก ุงููุณุฌููู ูุบูุฑ ุงููุณุฌููู
- โ ูุฏุนู ุงูููุชุฌุงุช ูุน variants
- โ ูุชูุงููุฉ ูุน ุจุงูู ุงูููุฒุงุช

**ุงูุชุญุณููุงุช ุงูููุชุฑุญุฉ:**
1. ุฅุถุงูุฉ Wishlist Count ูู Navigation
2. ุฅุถุงูุฉ ููุฒุฉ ูุดุงุฑูุฉ ุงููุงุฆูุฉ
3. ุฅุถุงูุฉ ุฅุดุนุงุฑุงุช ุนูุฏ ุงูุฎูุงุถ ุงูุณุนุฑ

---

## ๐ ููุงุญุธุงุช ุชูููุฉ

- ูุณุชุฎุฏู `localStorage` ูุญูุธ `wishlist_session_id`
- ูุฑุณู `x-session-id` header ูู ุฌููุน ุงูุทูุจุงุช
- ูุณุชุฎุฏู `wishlistUpdated` event ููุชุญุฏูุซุงุช
- ูุฏุนู `companyId` ู `subdomain` modes

---

**ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ:** $(Get-Date -Format "yyyy-MM-dd HH:mm:ss")


