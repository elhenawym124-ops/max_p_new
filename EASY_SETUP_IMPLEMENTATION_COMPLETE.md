# โ ุชู ุงูุชูููุฐ ุจูุฌุงุญ! - ููุฒุฉ ุงูุฑุจุท ุงูุณูู ูู Facebook Pixel

## ๐ ุงูููุฎุต

ุชู ุชูููุฐ ููุฒุฉ ุงูุฑุจุท ุงูุณูู ุจูุฌุงุญ! ุงูุขู ุนููุงุคู ูููููู ุฑุจุท Facebook Pixel ูู **2-3 ุฏูุงุฆู ููุท** ุจุฏูุงู ูู 15-30 ุฏูููุฉ.

---

## โ ูุง ุชู ุชูููุฐู

### **1. Backend (Node.js)** โ

#### **ุฃ. ุชุญุฏูุซ OAuth Permissions**
```javascript
// ููู: backend/routes/facebookOAuthRoutes.js
// ุงูุณุทุฑ: 30

const FACEBOOK_SCOPES = 
  'public_profile,email,pages_show_list,...,business_management,' +
  'ads_management,ads_read'; // ๐ ุชูุช ุงูุฅุถุงูุฉ
```

#### **ุจ. Endpoint ุฌุฏูุฏ: ุฌูุจ Pixels**
```javascript
// ููู: backend/routes/facebookOAuthRoutes.js
// ุงูุณุทุฑ: 870-1001

GET /api/v1/facebook-oauth/pixels?companyId=xxx

ุงููุธููุฉ:
- ูุฌูุจ ุฌููุน Business Accounts ูููุณุชุฎุฏู
- ูุฌูุจ ุฌููุน Pixels ููู Business
- ูุฑุฌุน ูุงุฆูุฉ ุจุฌููุน Pixels ุงููุชุงุญุฉ

ุงููุฎุฑุฌุงุช:
{
  success: true,
  pixels: [
    {
      pixelId: "123456789",
      pixelName: "ูุชุฌุฑ ุฃุญูุฏ",
      businessId: "987654321",
      businessName: "ุดุฑูุฉ ุฃุญูุฏ"
    }
  ],
  count: 1
}
```

#### **ุฌ. Endpoint ุฌุฏูุฏ: ุชูููุฏ Access Token**
```javascript
// ููู: backend/routes/facebookOAuthRoutes.js
// ุงูุณุทุฑ: 1003-1101

POST /api/v1/facebook-oauth/generate-pixel-token
Body: { pixelId, businessId }
Query: companyId=xxx

ุงููุธููุฉ:
- ูุญุงูู ุชูููุฏ System User Token (ููุฅูุชุงุฌ)
- Fallback: ูุฑุฌุน User Access Token

ุงููุฎุฑุฌุงุช:
{
  success: true,
  accessToken: "EAAxxxxx...",
  tokenType: "user_token"
}
```

---

### **2. Frontend (React/TypeScript)** โ

#### **ุฃ. ุฅุถุงูุฉ States ุฌุฏูุฏุฉ**
```typescript
// ููู: frontend/src/pages/advertising/FacebookPixelSettings.tsx
// ุงูุณุทุฑ: 84-89

const [pixels, setPixels] = useState<any[]>([]);
const [showPixelSelector, setShowPixelSelector] = useState(false);
const [fetchingPixels, setFetchingPixels] = useState(false);
const [showManualSetup, setShowManualSetup] = useState(false);
const { user } = useAuth();
```

#### **ุจ. Functions ุฌุฏูุฏุฉ**
```typescript
// ุงูุณุทุฑ: 225-326

1. handleEasyConnect()
   - ูุชุญูู ูู OAuth status
   - ุฅุฐุง ุบูุฑ ูุฑุจูุท: ููุชุญ OAuth
   - ุฅุฐุง ูุฑุจูุท: ูุฌูุจ Pixels

2. fetchPixels()
   - ูุณุชุฏุนู API ูุฌูุจ Pixels
   - ูุนุฑุถ ูุงุฆูุฉ ุงูุงุฎุชูุงุฑ

3. handleSelectPixel(pixel)
   - ูุญูุธ Pixel ID
   - ูุญุงูู ุชูููุฏ Access Token
   - ูุญูุธ ุงูุฅุนุฏุงุฏุงุช
```

#### **ุฌ. ูุงุฌูุฉ ุงูุฑุจุท ุงูุณูู**
```typescript
// ุงูุณุทุฑ: 389-479

1. ูุณู "ุงูุทุฑููุฉ ุงูุณููุฉ"
   - ูุธูุฑ ููุท ุฅุฐุง ูู ููู Pixel ID ููุฌูุฏ
   - ุฒุฑ "ุฑุจุท ูุน Facebook ุชููุงุฆูุงู"
   - 3 ูููุฒุงุช ูุงุถุญุฉ

2. ูุงุฆูุฉ ุงุฎุชูุงุฑ Pixels
   - ุชุธูุฑ ุจุนุฏ ุงูุฑุจุท
   - ูู Pixel ูู ุจุทุงูุฉ ูููุตูุฉ
   - ูุนูููุงุช ูุงุถุญุฉ (Name, ID, Business)

3. Divider "ุฃู"
   - ููุตู ุจูู ุงูุทุฑููุฉ ุงูุณููุฉ ูุงููุฏููุฉ
```

---

## ๐ ููู ุชุนูู ุงูููุฒุฉุ

### **ุงูุณููุงุฑูู 1: ูุณุชุฎุฏู ุฌุฏูุฏ**

```
1. ููุชุญ /advertising/facebook-pixel
   โ
2. ูุดูู "ุงูุทุฑููุฉ ุงูุณููุฉ" ูู ุงูุฃุนูู
   โ
3. ูุถุบุท "ุฑุจุท ูุน Facebook ุชููุงุฆูุงู"
   โ
4. OAuth โ ูุณุฌู ุฏุฎูู Facebook
   โ
5. ูุฎุชุงุฑ Pixel ูู ุงููุงุฆูุฉ
   โ
6. ุชู! โ Pixel ID ู Token ูุญููุธูู
```

### **ุงูุณููุงุฑูู 2: ูุณุชุฎุฏู ูุฑุจูุท ุจุงููุนู**

```
1. ููุชุญ /advertising/facebook-pixel
   โ
2. ูุถุบุท "ุฑุจุท ูุน Facebook"
   โ
3. ูุฌูุจ Pixels ูุจุงุดุฑุฉ (ุจุฏูู OAuth)
   โ
4. ูุฎุชุงุฑ Pixel
   โ
5. ุชู! โ
```

---

## ๐จ ุงูุดูู ุงูููุงุฆู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Facebook Pixel & Conversions API           โ
โ  [ุญูุธ ุงูุฅุนุฏุงุฏุงุช]                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                             โ
โ  ๐ก ูุตูุญุฉ: ูุนูู Pixel + CAPI ููุฏูุฉ ุงูุฃุนูู  โ
โ                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                             โ
โ  ๐ ุงูุทุฑููุฉ ุงูุณููุฉ (ููุตู ุจูุง)              โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ  ๐ [ุฑุจุท ูุน Facebook ุชููุงุฆูุงู]       โ โ
โ  โ                                       โ โ
โ  โ  โ ุณูู ูุณุฑูุน (2-3 ุฏูุงุฆู)            โ โ
โ  โ  โ ูุง ูุญุชุงุฌ ูุณุฎ ููุตู                โ โ
โ  โ  โ Access Token ุชููุงุฆู               โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                             โ
โ  โโโโโโโโโโโโโโโ ุฃู โโโโโโโโโโโโโโโ         โ
โ                                             โ
โ  ๐ Facebook Pixel (ุงูุทุฑููุฉ ุงููุฏููุฉ)       โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ  Pixel ID: [___________] [ุงุฎุชุจุงุฑ]    โ โ
โ  โ  ...                                  โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

### **ุงูุฎุทูุฉ 1: ุชุดุบูู Backend**
```bash
cd backend
npm start
```

### **ุงูุฎุทูุฉ 2: ุชุดุบูู Frontend**
```bash
cd frontend
npm start
```

### **ุงูุฎุทูุฉ 3: ุงูุงุฎุชุจุงุฑ**
```
1. ุงูุชุญ: http://localhost:3000/advertising/facebook-pixel
2. ุงุถุบุท "ุฑุจุท ูุน Facebook ุชููุงุฆูุงู"
3. ุณุฌู ุฏุฎูู Facebook
4. ุงุฎุชุฑ Pixel ูู ุงููุงุฆูุฉ
5. ุชุญูู ูู ุญูุธ ุงูุจูุงูุงุช
```

---

## ๐ ุงููููุงุช ุงูููุนุฏููุฉ

### **Backend:**
```
โ backend/routes/facebookOAuthRoutes.js
   - ุงูุณุทุฑ 30: ุชุญุฏูุซ Permissions
   - ุงูุณุทุฑ 870-1001: Endpoint /pixels
   - ุงูุณุทุฑ 1003-1101: Endpoint /generate-pixel-token
```

### **Frontend:**
```
โ frontend/src/pages/advertising/FacebookPixelSettings.tsx
   - ุงูุณุทุฑ 17-18: ุฅุถุงูุฉ imports
   - ุงูุณุทุฑ 84-89: ุฅุถุงูุฉ states
   - ุงูุณุทุฑ 225-326: ุฅุถุงูุฉ functions
   - ุงูุณุทุฑ 389-479: ุฅุถุงูุฉ ูุงุฌูุฉ ุงูุฑุจุท ุงูุณูู
```

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

### **1. Facebook App Permissions**
```
ุชุฃูุฏ ูู ุฃู Facebook App ุนูุฏู ุนูุฏู:
- ads_management
- ads_read
- business_management

ุฅุฐุง ูู ุชูู ููุฌูุฏุฉุ ุงุฐูุจ ุฅูู:
Facebook Developers โ App โ App Review โ Permissions
```

### **2. Access Token**
```
ุญุงููุงู: User Access Token (ููุชูู ุจุนุฏ 60 ููู)
ููุฅูุชุงุฌ: ูููุตุญ ุจุฅูุดุงุก System User Token (ูุง ููุชูู)

ุงูููุฏ ุฌุงูุฒ ูุฏุนู System User Token ูู ุงููุณุชูุจู
```

### **3. Error Handling**
```
ุงูููุฏ ูุชุนุงูู ูุน:
โ ูุณุชุฎุฏู ุบูุฑ ูุฑุจูุท โ ููุชุญ OAuth
โ ูุง ููุฌุฏ Pixels โ ูุนุฑุถ ุฑุณุงูุฉ + ุงูุทุฑููุฉ ุงููุฏููุฉ
โ ูุดู ุชูููุฏ Token โ ูุณุชุฎุฏู User Token
โ ุฃุฎุทุงุก ุงูุดุจูุฉ โ ุฑุณุงุฆู ูุงุถุญุฉ
```

---

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ (ุงุฎุชูุงุฑู)

### **ุชุญุณููุงุช ูุณุชูุจููุฉ:**

1. **System User Token**
   ```javascript
   // ูู generate-pixel-token endpoint
   // ุฅุถุงูุฉ logic ูุฅูุดุงุก System User Token
   // ุจุฏูุงู ูู ุงุณุชุฎุฏุงู User Token
   ```

2. **Token Refresh**
   ```javascript
   // ุฅุถุงูุฉ cron job ูุชุฌุฏูุฏ Tokens ุชููุงุฆูุงู
   // ูุจู ุงูุชูุงุก ุตูุงุญูุชูุง
   ```

3. **Multiple Pixels**
   ```javascript
   // ุงูุณูุงุญ ุจุงุฎุชูุงุฑ ุฃูุซุฑ ูู Pixel
   // ูููุณ ุงูุดุฑูุฉ
   ```

4. **Analytics**
   ```javascript
   // ุฅุถุงูุฉ tracking ููุนุฑูุฉ:
   // - ูู ูุณุชุฎุฏู ุงุณุชุฎุฏู ุงูุทุฑููุฉ ุงูุณููุฉ
   // - ูู ูุณุชุฎุฏู ุงุณุชุฎุฏู ุงูุทุฑููุฉ ุงููุฏููุฉ
   ```

---

## ๐ ุงูููุงุฑูุฉ: ูุจู ูุจุนุฏ

| ุงูููุฒุฉ | ูุจู | ุจุนุฏ |
|--------|-----|-----|
| **ุงูููุช** | 15-30 ุฏูููุฉ | 2-3 ุฏูุงุฆู โ |
| **ุงูุฎุทูุงุช** | 10+ ุฎุทูุงุช | 3 ุฎุทูุงุช โ |
| **ุงูุฃุฎุทุงุก** | ุดุงุฆุนุฉ | ูุงุฏุฑุฉ โ |
| **ุณูููุฉ** | ูุชูุณุทุฉ | ุณููุฉ ุฌุฏุงู โ |
| **ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู** | ููุจููุฉ | ููุชุงุฒุฉ โ |

---

## ๐ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### **ููุนููุงุก:**
- โ ุฑุจุท ุณูู ูุณุฑูุน (2-3 ุฏูุงุฆู)
- โ ูุง ุญุงุฌุฉ ููุณุฎ ููุตู
- โ Access Token ุชููุงุฆู
- โ ุชุฌุฑุจุฉ ูุซู WooCommerce Plugin

### **ูู:**
- โ ุชูููู ุฏุนู ุงูุนููุงุก
- โ ุฒูุงุฏุฉ ูุนุฏู ุงูุชูุนูู
- โ ููุฒุฉ ุชูุงูุณูุฉ ูููุฉ
- โ ุงุญุชูุงุธ ุจุงูุฃุฏุงุก ุงูุนุงูู (8-9/10 EMQ)

---

## ๐ ุงูุฏุนู

ุฅุฐุง ูุงุฌูุช ุฃู ูุดููุฉ:

1. **ุชุญูู ูู Console:**
   ```
   Backend: ุชุญูู ูู logs ูู terminal
   Frontend: ุงูุชุญ DevTools โ Console
   ```

2. **ุชุญูู ูู Permissions:**
   ```
   Facebook Developers โ App โ Permissions
   ุชุฃูุฏ ูู: ads_management, ads_read
   ```

3. **ุชุญูู ูู OAuth:**
   ```
   GET /api/v1/facebook-oauth/status?companyId=xxx
   ูุฌุจ ุฃู ูุฑุฌุน: { connected: true }
   ```

---

## โ ุงูุฎูุงุตุฉ

**ุชู ุงูุชูููุฐ ุจูุฌุงุญ!** ๐

ุงูุขู ุนููุงุคู ูููููู:
- โ ุฑุจุท Facebook Pixel ูู 2-3 ุฏูุงุฆู
- โ ุงูุญุตูู ุนูู Access Token ุชููุงุฆูุงู
- โ ุงูุงุณุชูุชุงุน ุจุชุฌุฑุจุฉ ุณููุฉ ูุซู WooCommerce
- โ ูุน ุงูุงุญุชูุงุธ ุจุงูุฃุฏุงุก ุงูุนุงูู (8-9/10 EMQ)

**ุฃูุถู ูุง ูู ุงูุนุงูููู!** ๐
