# ๐ ุชุญููู ุชูุตููู - ูุดููุฉ ุทูู ุงูู Prompt ุงูููุฑุท

**ุชุงุฑูุฎ ุงูุชุญููู:** 2025-11-28  
**ุงููุฏู:** ุดุฑุญ ุชูุตููู ููุดููุฉ ุทูู ุงูู Prompt ูุงููููุงุช ุงููุดุงุฑูุฉ ูุงูุชุญุณููุงุช ุงูููุชุฑุญุฉ

---

## ๐ ุงููุดููุฉ ุจุงูุชูุตูู

### ุงูุทูู ุงูุญุงูู ููู Prompt:

**ุงูุทูู ุงููุชููุน:** 5000-8000 ุญุฑู (ุฃู ุฃูุซุฑ) ูู ุงูุญุงูุงุช ุงููุนูุฏุฉ

**ูุซุงู ูู ุงูู Logs:**
```
๐ [BUILD-PROMPT] ุทูู ุงูู Prompt ุงูููุงุฆู: 7035 ุญุฑู
```

### ุงุณุชููุงู Tokens:

- **Prompt Tokens:** ~2000-3000 tokens (ุญุณุจ ุงูุทูู)
- **Response Tokens:** ~200-500 tokens
- **Total:** ~2200-3500 tokens ููู ุทูุจ

**ุงูุชูููุฉ:**
- ุฅุฐุง ูุงู ุงูุณุนุฑ $0.0001 ููู 1000 tokens
- ูู ุทูุจ ูููู: $0.00022 - $0.00035
- ูู 1000 ุทูุจ: $0.22 - $0.35
- ูู 100,000 ุทูุจ: $22 - $35

---

## ๐ ุงููููุงุช ูุงููุญุฏุงุช ุงููุดุงุฑูุฉ ูู ุจูุงุก ุงูู Prompt

### 1. ุงูููู ุงูุฑุฆูุณู: `responseGenerator.js`

**ุงูุฏุงูุฉ:** `buildAdvancedPrompt()` - ุงูุณุทุฑ 294

**ุงููุณุคูููุงุช:**
- โ ุชูุณูู ุฌููุน ุงูุฃูุณุงู
- โ ุฅุถุงูุฉ ุงูุฃูุณุงู ุญุณุจ ุงูุญุงุฌุฉ
- โ ุฅุฏุงุฑุฉ ุชุฏูู ุงููุนูููุงุช

---

### 2. ุงููููุงุช ุงููุณุชูุฑุฏุฉ (Dependencies):

#### ุฃ. `responseRulesConfig.js`
**ุงูุฏุงูุฉ:** `buildPromptFromRules()`
**ุงููุณุงููุฉ:** ~400-600 ุญุฑู
**ุงูุงุณุชุฎุฏุงู:** ุฅุถุงูุฉ ููุงุนุฏ ุงูุงุณุชุฌุงุจุฉ (ุทูู ุงูุฑุฏุ ุฃุณููุจ ุงูููุงูุ ุงูููุฌุฉุ ููุงุนุฏ ุฅุถุงููุฉ)

#### ุจ. `dynamicPromptBuilder.js` (ุงุฎุชูุงุฑู)
**ุงูุฏูุงู:** `detectEmotionalState()`, `detectCustomerTone()`, `detectUrgencyLevel()`
**ุงููุณุงููุฉ:** ~50-100 ุญุฑู (ููุงุญุธุงุช ูุฎุชุตุฑุฉ)
**ุงูุงุณุชุฎุฏุงู:** ุชุญููู ุงูุณูุงู ุงูุนุงุทูู

#### ุฌ. `shippingService.js` (ุงุฎุชูุงุฑู)
**ุงูุฏูุงู:** `isAskingAboutShipping()`, `extractGovernorateFromMessage()`, `findShippingInfo()`, `getAvailableGovernorates()`
**ุงููุณุงููุฉ:** ~300-800 ุญุฑู (ุญุณุจ ุงูุญุงูุฉ)
**ุงูุงุณุชุฎุฏุงู:** ุฅุถุงูุฉ ูุนูููุงุช ุงูุดุญู

#### ุฏ. `productExtractor.js`
**ุงูุฏุงูุฉ:** `extractProduct()`
**ุงููุณุงููุฉ:** ~0-200 ุญุฑู (ุณูุงู ุงูููุชุฌ)
**ุงูุงุณุชุฎุฏุงู:** ุงุณุชุฎุฑุงุฌ ุขุฎุฑ ููุชุฌ ูุฐููุฑ

#### ูู. `memoryService.js` (ุบูุฑ ูุจุงุดุฑ)
**ุงููุณุงููุฉ:** ~500-2000 ุญุฑู (ุญุณุจ ุนุฏุฏ ุงูุฑุณุงุฆู)
**ุงูุงุณุชุฎุฏุงู:** ุฌูุจ ุณุฌู ุงููุญุงุฏุซุฉ

#### ู. `ragService.js` (ุบูุฑ ูุจุงุดุฑ)
**ุงููุณุงููุฉ:** ~300-1500 ุญุฑู (ุญุณุจ ุนุฏุฏ ุงูููุชุฌุงุช)
**ุงูุงุณุชุฎุฏุงู:** ุฌูุจ ุงูููุชุฌุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

---

## ๐ ุงูุฃูุณุงู ุงููุถุงูุฉ ููู Prompt (ุจุงูุชุฑุชูุจ)

### ุงููุณู 1: Personality Prompt
**ุงูุทูู:** ~200-500 ุญุฑู  
**ุงููุตุฏุฑ:** ูุงุนุฏุฉ ุงูุจูุงูุงุช (`companyPrompts.personalityPrompt`)  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 311  
**ุงูุฃูููุฉ:** โญโญโญโญโญ (ุฃุณุงุณู)

```javascript
prompt += `${companyPrompts.personalityPrompt.trim()}\n\n`;
```

---

### ุงููุณู 2: ููุงุนุฏ ุงูุงุณุชุฌุงุจุฉ (Response Rules)
**ุงูุทูู:** ~400-600 ุญุฑู  
**ุงููุตุฏุฑ:** `responseRulesConfig.js` - `buildPromptFromRules()`  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 326  
**ุงูุฃูููุฉ:** โญโญโญโญโญ (ุฃุณุงุณู)

**ุงููุญุชูู:**
- ุทูู ุงูุฑุฏ (ูุตูุฑ/ูุชูุณุท/ููุตู)
- ุฃุณููุจ ุงูููุงู (ุฑุณูู/ูุฏูุฏ/ูุฑุญ)
- ุงูููุฌุฉ (ูุตุฑูุฉ/ุฎููุฌูุฉ/ุดุงููุฉ)
- ููุงุนุฏ ุฅุถุงููุฉ (10-15 ูุงุนุฏุฉ)

---

### ุงููุณู 3: ุชุญุฐูุฑ ุนุฏู ุงูุชุฑุญูุจ
**ุงูุทูู:** ~200-250 ุญุฑู  
**ุงููุตุฏุฑ:** `responseGenerator.js` - ุงูุณุทุฑ 368-375  
**ุงูุฃูููุฉ:** โญโญโญโญ (ููู ุฌุฏุงู)

**ููุถุงู ููุท ุฅุฐุง:** `conversationMemory.length > 0`

---

### ุงููุณู 4: ุชุญููู ุงูุณูุงู ุงูุนุงุทูู
**ุงูุทูู:** ~50-100 ุญุฑู  
**ุงููุตุฏุฑ:** `dynamicPromptBuilder.js`  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 380-395  
**ุงูุฃูููุฉ:** โญโญโญ (ูููุฏ)

**ููุถุงู ููุท ุฅุฐุง:** ููุงู ุญุงูุฉ ุนุงุทููุฉ ุฎุงุตุฉ (ููุฒุนุฌุ ุนุงุฌูุ ุฑุณูู)

---

### ุงููุณู 5: ูุนูููุงุช ุงูุดุญู
**ุงูุทูู:** ~300-800 ุญุฑู  
**ุงููุตุฏุฑ:** `shippingService.js`  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 400-461  
**ุงูุฃูููุฉ:** โญโญโญโญ (ููู ุนูุฏ ุงูุญุงุฌุฉ)

**ููุถุงู ููุท ุฅุฐุง:** ุงูุนููู ูุณุฃู ุนู ุงูุดุญู ุฃู ูุฐูุฑ ูุญุงูุธุฉ

**ุงูุญุงูุงุช:**
- ูุญุงูุธุฉ ูุฐููุฑุฉ: ~300 ุญุฑู
- ูุญุงูุธุฉ ุบูุฑ ูุฐููุฑุฉ: ~500-800 ุญุฑู (ูุงุฆูุฉ ุงููุญุงูุธุงุช)

---

### ุงููุณู 6: Response Prompt (ุงุฎุชูุงุฑู)
**ุงูุทูู:** ~100-300 ุญุฑู  
**ุงููุตุฏุฑ:** ูุงุนุฏุฉ ุงูุจูุงูุงุช (`companyPrompts.responsePrompt`)  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 464-466  
**ุงูุฃูููุฉ:** โญโญโญ (ุงุฎุชูุงุฑู)

---

### ุงููุณู 7: ูุนูููุงุช ุงูุนููู
**ุงูุทูู:** ~150-200 ุญุฑู  
**ุงููุตุฏุฑ:** `customerData`  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 472-476  
**ุงูุฃูููุฉ:** โญโญโญโญ (ููู)

**ุงููุญุชูู:**
- ุงูุงุณู
- ุงููุงุชู
- ุญุงูุฉ ุงูุนููู (ุฌุฏูุฏ/ุฑุงุฌุน)
- ูุฑุญูุฉ ุงููุญุงุฏุซุฉ

---

### ุงููุณู 8: ุชุนูููุงุช ูุฑุงุกุฉ ุงููุญุงุฏุซุฉ
**ุงูุทูู:** ~300-350 ุญุฑู  
**ุงููุตุฏุฑ:** `responseGenerator.js` - ุงูุณุทุฑ 479-491  
**ุงูุฃูููุฉ:** โญโญโญโญโญ (ุฃุณุงุณู)

**ุงููุญุชูู:**
- ููุงุนุฏ ูุฑุงุกุฉ ุงููุญุงุฏุซุฉ ูุจู ุงูุณุคุงู
- ุฃูุซูุฉ ุนูู ูุง ูุฌุจ ุชุฌูุจู

---

### ุงููุณู 9: ูุนูููุงุช ุงูููุชุฌ ูู ุงูุจูุณุช
**ุงูุทูู:** ~300-400 ุญุฑู  
**ุงููุตุฏุฑ:** `messageData.postProductInfo`  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 494-511  
**ุงูุฃูููุฉ:** โญโญโญโญ (ููู ุนูุฏ ุงูุญุงุฌุฉ)

**ููุถุงู ููุท ุฅุฐุง:** `messageData.isPostProductResponse === true`

---

### ุงููุณู 10: ูุนูููุงุช ุงูููุดูุฑ
**ุงูุทูู:** ~200-500 ุญุฑู  
**ุงููุตุฏุฑ:** `messageData.postDetails`  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 514-539  
**ุงูุฃูููุฉ:** โญโญโญ (ูููุฏ ุนูุฏ ุงูุญุงุฌุฉ)

**ููุถุงู ููุท ุฅุฐุง:** `messageData.postDetails` ููุฌูุฏ

---

### ุงููุณู 11: ุณูุงู ุงูุฑุฏ (Reply Context)
**ุงูุทูู:** ~200-300 ุญุฑู  
**ุงููุตุฏุฑ:** `messageData.replyContext`  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 542-560  
**ุงูุฃูููุฉ:** โญโญโญโญ (ููู ุนูุฏ ุงูุญุงุฌุฉ)

**ููุถุงู ููุท ุฅุฐุง:** `messageData.replyContext.isReply === true`

---

### ุงููุณู 12: ุณุฌู ุงููุญุงุฏุซุฉ (Conversation Memory) โ๏ธ **ุงูุฃูุจุฑ**
**ุงูุทูู:** ~500-2000 ุญุฑู  
**ุงููุตุฏุฑ:** `conversationMemory` (ูู `memoryService`)  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 590-761  
**ุงูุฃูููุฉ:** โญโญโญโญโญ (ุฃุณุงุณู ููู ุทููู ุฌุฏุงู)

**ุงููุญุชูู:**
- ุชุญุฐูุฑุงุช ูุชูุฑุฑุฉ (3 ูุฑุงุช)
- ุขุฎุฑ 5 ุฑุณุงุฆู ูุน ุชูุงุตูู ูุซูุฑุฉ
- ููุงุญุธุงุช ููู ุฑุณุงูุฉ (ููุชุฌุ ุณุนุฑุ ููุงุตูุงุชุ ุจูุงูุงุช)
- ุชุนูููุงุช ุทูููุฉ (7 ููุงุท)

**ุงููุดููุฉ:** โ๏ธ ูุฐุง ุงููุณู ุทููู ุฌุฏุงู ููุชูุฑุฑ

**ุงูุชูุงุตูู:**
- ูู ุฑุณุงูุฉ: ~100-200 ุญุฑู
- 5 ุฑุณุงุฆู: ~500-1000 ุญุฑู
- ุงูุชุญุฐูุฑุงุช ูุงูุชุนูููุงุช: ~500-1000 ุญุฑู
- **ุงูุฅุฌูุงูู:** ~1000-2000 ุญุฑู

---

### ุงููุณู 13: ุณูุงู ุขุฎุฑ ููุชุฌ ูุฐููุฑ
**ุงูุทูู:** ~200-600 ุญุฑู  
**ุงููุตุฏุฑ:** `productExtractor.extractProduct()`  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 674-753  
**ุงูุฃูููุฉ:** โญโญโญโญ (ููู ุนูุฏ ุงูุญุงุฌุฉ)

**ููุถุงู ููุท ุฅุฐุง:** `lastMentionedProduct` ููุฌูุฏ

**ุงูุญุงูุงุช:**
- ุทูุจ ุจุฏูู ููุชุฌ: ~400-600 ุญุฑู (ุชุนูููุงุช ููุตูุฉ)
- ูุนูููุงุช ุนุงูุฉ: ~200-300 ุญุฑู

---

### ุงููุณู 14: RAG Data (ุงูููุชุฌุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช) โ๏ธ **ุทููู**
**ุงูุทูู:** ~300-1500 ุญุฑู  
**ุงููุตุฏุฑ:** `ragData` (ูู `ragService`)  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 798-897  
**ุงูุฃูููุฉ:** โญโญโญโญโญ (ุฃุณุงุณู ููู ุทููู)

**ุงููุญุชูู:**
- ูุนูููุงุช ูู ููุชุฌ (ุงูุงุณูุ ุงูุณุนุฑุ ุงูููุงุตูุงุช)
- ุญุงูุฉ ุงูุตูุฑ
- ุนุฏุฏ ุงูููุชุฌุงุช: 1-10 ููุชุฌุงุช

**ุงููุดููุฉ:** โ๏ธ ูู ููุชุฌ ูุถูู ~100-200 ุญุฑู

**ูุซุงู:**
- 1 ููุชุฌ: ~200 ุญุฑู
- 5 ููุชุฌุงุช: ~1000 ุญุฑู
- 10 ููุชุฌุงุช: ~2000 ุญุฑู

---

### ุงููุณู 15: ุชุนูููุงุช ุฌูุฏุฉ ุงูุฑุฏ
**ุงูุทูู:** ~400-500 ุญุฑู  
**ุงููุตุฏุฑ:** `responseGenerator.js` - ุงูุณุทุฑ 900-950  
**ุงูุฃูููุฉ:** โญโญโญโญ (ููู)

**ุงููุญุชูู:**
- 5 ููุงุท ุฑุฆูุณูุฉ
- ููุงุนุฏ ุงูุตูุฑ ูุงูุฃุณุนุงุฑ

---

### ุงููุณู 16: ุฑุณุงูุฉ ุงูุนููู
**ุงูุทูู:** ~50-200 ุญุฑู  
**ุงููุตุฏุฑ:** `customerMessage`  
**ุงูููู:** `responseGenerator.js` - ุงูุณุทุฑ 953  
**ุงูุฃูููุฉ:** โญโญโญโญโญ (ุฃุณุงุณู)

---

### ุงููุณู 17: ุชูุจููุงุช ููุฑุณุงุฆู ุงูุบุงูุถุฉ
**ุงูุทูู:** ~150-200 ุญุฑู  
**ุงููุตุฏุฑ:** `responseGenerator.js` - ุงูุณุทุฑ 962-970  
**ุงูุฃูููุฉ:** โญโญโญ (ูููุฏ)

**ููุถุงู ููุท ุฅุฐุง:** ุงูุฑุณุงูุฉ ุบุงูุถุฉ

---

## ๐ ุฅุฌูุงูู ุงูุทูู ุญุณุจ ุงูุญุงูุฉ

### ุงูุญุงูุฉ 1: ูุญุงุฏุซุฉ ุฌุฏูุฏุฉ ุจุฏูู ููุชุฌุงุช
- Personality: 300
- Response Rules: 500
- ูุนูููุงุช ุงูุนููู: 200
- ุชุนูููุงุช: 300
- ุฑุณุงูุฉ ุงูุนููู: 100
- **ุงูุฅุฌูุงูู:** ~1400 ุญุฑู โ (ููุจูู)

---

### ุงูุญุงูุฉ 2: ูุญุงุฏุซุฉ ูุชูุณุทุฉ (5 ุฑุณุงุฆูุ 3 ููุชุฌุงุช)
- Personality: 300
- Response Rules: 500
- ุชุญุฐูุฑ ุงูุชุฑุญูุจ: 200
- ูุนูููุงุช ุงูุนููู: 200
- ุชุนูููุงุช: 300
- ุณุฌู ุงููุญุงุฏุซุฉ: 1200 โ๏ธ
- RAG Data (3 ููุชุฌุงุช): 600 โ๏ธ
- ุชุนูููุงุช ุงูุฌูุฏุฉ: 500
- ุฑุณุงูุฉ ุงูุนููู: 100
- **ุงูุฅุฌูุงูู:** ~3900 ุญุฑู โ๏ธ (ุทููู)

---

### ุงูุญุงูุฉ 3: ูุญุงุฏุซุฉ ูุนูุฏุฉ (10+ ุฑุณุงุฆูุ 5 ููุชุฌุงุชุ ุดุญู)
- Personality: 300
- Response Rules: 500
- ุชุญุฐูุฑ ุงูุชุฑุญูุจ: 200
- ูุนูููุงุช ุงูุดุญู: 500
- ูุนูููุงุช ุงูุนููู: 200
- ุชุนูููุงุช: 300
- ุณุฌู ุงููุญุงุฏุซุฉ: 2000 โ๏ธโ๏ธ
- ุณูุงู ุงูููุชุฌ: 400
- RAG Data (5 ููุชุฌุงุช): 1000 โ๏ธ
- ุชุนูููุงุช ุงูุฌูุฏุฉ: 500
- ุฑุณุงูุฉ ุงูุนููู: 100
- **ุงูุฅุฌูุงูู:** ~6000 ุญุฑู โ๏ธโ๏ธ (ุทููู ุฌุฏุงู)

---

### ุงูุญุงูุฉ 4: ุญุงูุฉ ูุนูุฏุฉ ุฌุฏุงู (15+ ุฑุณุงุฆูุ 10 ููุชุฌุงุชุ ุดุญูุ ุจูุณุช)
- Personality: 300
- Response Rules: 500
- ุชุญุฐูุฑ ุงูุชุฑุญูุจ: 200
- ูุนูููุงุช ุงูุดุญู: 800
- ูุนูููุงุช ุงูุนููู: 200
- ุชุนูููุงุช: 300
- ูุนูููุงุช ุงูุจูุณุช: 400
- ุณุฌู ุงููุญุงุฏุซุฉ: 2500 โ๏ธโ๏ธโ๏ธ
- ุณูุงู ุงูููุชุฌ: 600
- RAG Data (10 ููุชุฌุงุช): 2000 โ๏ธโ๏ธ
- ุชุนูููุงุช ุงูุฌูุฏุฉ: 500
- ุฑุณุงูุฉ ุงูุนููู: 200
- **ุงูุฅุฌูุงูู:** ~8500 ุญุฑู โ๏ธโ๏ธโ๏ธ (ููุฑุท)

---

## ๐ข ุนุฏุฏ ุงููููุงุช ุงููุดุงุฑูุฉ

### ุงููููุงุช ุงููุจุงุดุฑุฉ (Direct):
1. โ `responseGenerator.js` - ุงูููู ุงูุฑุฆูุณู
2. โ `responseRulesConfig.js` - ููุงุนุฏ ุงูุงุณุชุฌุงุจุฉ
3. โ `dynamicPromptBuilder.js` - ุชุญููู ุงูุณูุงู (ุงุฎุชูุงุฑู)
4. โ `shippingService.js` - ูุนูููุงุช ุงูุดุญู (ุงุฎุชูุงุฑู)
5. โ `productExtractor.js` - ุงุณุชุฎุฑุงุฌ ุงูููุชุฌ

### ุงููููุงุช ุบูุฑ ุงููุจุงุดุฑุฉ (Indirect):
6. โ `memoryService.js` - ุฌูุจ ุณุฌู ุงููุญุงุฏุซุฉ
7. โ `ragService.js` - ุฌูุจ ุงูููุชุฌุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
8. โ `aiAgentService.js` - ุชูุณูู ุงูุนูููุฉ

**ุงูุฅุฌูุงูู:** 8 ูููุงุช (5 ูุจุงุดุฑุฉ + 3 ุบูุฑ ูุจุงุดุฑุฉ)

---

## โ๏ธ ุงููุดุงูู ุงูุฑุฆูุณูุฉ

### 1. ุงูุชูุฑุงุฑ ุงูููุฑุท โ๏ธโ๏ธโ๏ธ

**ุงููุดููุฉ:**
- ููุณ ุงูุชุญุฐูุฑุงุช ุชููุฑุฑ 3-4 ูุฑุงุช
- ููุณ ุงูุชุนูููุงุช ูู ุฃูุงูู ูุชุนุฏุฏุฉ

**ุงูุฃูุซูุฉ:**
- ุชุญุฐูุฑ ุนุฏู ุงูุชุฑุญูุจ: ูุธูุฑ ูู 3 ุฃูุงูู ูุฎุชููุฉ
- ุชุนูููุงุช ูุฑุงุกุฉ ุงููุญุงุฏุซุฉ: ุชุธูุฑ ูุฑุชูู
- ููุงุนุฏ ุงูุตูุฑ: ุชุธูุฑ ูู 3 ุฃูุงูู

**ุงูุชุฃุซูุฑ:**
- โ๏ธ ุฅุถุงูุฉ ~500-800 ุญุฑู ุบูุฑ ุถุฑูุฑู
- โ๏ธ ุชุดุชูุช AI ุนู ุงููุนูููุงุช ุงููููุฉ

---

### 2. ุณุฌู ุงููุญุงุฏุซุฉ ุทููู ุฌุฏุงู โ๏ธโ๏ธ

**ุงููุดููุฉ:**
- ุฅุถุงูุฉ ุขุฎุฑ 5 ุฑุณุงุฆู ูุงููุฉ
- ุฅุถุงูุฉ ููุงุญุธุงุช ููู ุฑุณุงูุฉ
- ุฅุถุงูุฉ ุชุนูููุงุช ุทูููุฉ ุจุนุฏ ูู ุฑุณุงูุฉ

**ุงูุชุฃุซูุฑ:**
- โ๏ธ ุฅุถุงูุฉ ~1000-2000 ุญุฑู
- โ๏ธ ูุนุธู ุงููุนูููุงุช ุบูุฑ ุถุฑูุฑูุฉ (ุงูุฑุณุงุฆู ุงููุฏููุฉ)

---

### 3. RAG Data ุบูุฑ ูุญุณูู โ๏ธ

**ุงููุดููุฉ:**
- ุฅุถุงูุฉ ุฌููุน ุงูููุชุฌุงุช ุจุฏูู ููุชุฑุฉ
- ุฅุถุงูุฉ ูุนูููุงุช ุบูุฑ ุถุฑูุฑูุฉ (ูุซู ุญุงูุฉ ุงูุตูุฑ ุจุงูุชูุตูู)

**ุงูุชุฃุซูุฑ:**
- โ๏ธ ุฅุถุงูุฉ ~300-2000 ุญุฑู ุญุณุจ ุนุฏุฏ ุงูููุชุฌุงุช
- โ๏ธ ูุฏ ูููู ููุงู 10 ููุชุฌุงุช ููู ุงูุนููู ูุฑูุฏ ูุงุญุฏ ููุท

---

### 4. ุชุนูููุงุช ุทูููุฉ ููุชูุฑุฑุฉ โ๏ธ

**ุงููุดููุฉ:**
- ุชุนูููุงุช ุฌูุฏุฉ ุงูุฑุฏ: 5 ููุงุท ุทูููุฉ
- ููุงุนุฏ ุงูุตูุฑ ูุงูุฃุณุนุงุฑ: ุชูุตูู ููุฑุท
- ุชุนูููุงุช ูุฑุงุกุฉ ุงููุญุงุฏุซุฉ: ุทูููุฉ ููุชูุฑุฑุฉ

**ุงูุชุฃุซูุฑ:**
- โ๏ธ ุฅุถุงูุฉ ~800-1000 ุญุฑู
- โ๏ธ ูุนุธู ุงูุชุนูููุงุช ูููู ุงุฎุชุตุงุฑูุง

---

## ๐ ุงูุชุญุณููุงุช ุงูููุชุฑุญุฉ (ุจุฏูู ุงูุชุฃุซูุฑ ุนูู ุงูุฌูุฏุฉ)

### ุงูุชุญุณูู 1: ุชูููู ุณุฌู ุงููุญุงุฏุซุฉ โ

**ุงูุญู:**
- ุชูููู ุนุฏุฏ ุงูุฑุณุงุฆู ูู 5 ุฅูู 3
- ุงุณุชุฎุฏุงู ููุฎุตุงุช ุจุฏูุงู ูู ุงููุตูุต ุงููุงููุฉ
- ุฅุฒุงูุฉ ุงูููุงุญุธุงุช ุงูุชูุตูููุฉ ููู ุฑุณุงูุฉ

**ุงูููุฏ ุงูุญุงูู:**
```javascript
const recentMessages = conversationMemory.slice(-5); // โ 5 ุฑุณุงุฆู
recentMessages.forEach((interaction, index) => {
  prompt += `[${position}] ${sender}:\n`;
  prompt += `   "${content}"\n`; // โ ุงููุต ุงููุงูู
  // ... ููุงุญุธุงุช ุชูุตูููุฉ ููู ุฑุณุงูุฉ
});
```

**ุงูููุฏ ุงููุญุณูู:**
```javascript
// โ ุชูููู ุฅูู 3 ุฑุณุงุฆู ููุท
const recentMessages = conversationMemory.slice(-3);

recentMessages.forEach((interaction, index) => {
  const sender = interaction.isFromCustomer ? 'ุงูุนููู' : 'ุฃูุชู';
  const content = interaction.content || '';
  
  // โ ุงุณุชุฎุฏุงู ููุฎุต ุจุฏูุงู ูู ุงููุต ุงููุงูู
  const summary = content.length > 100 
    ? content.substring(0, 100) + '...' 
    : content;
  
  prompt += `${sender}: ${summary}\n`;
  
  // โ ุฅุถุงูุฉ ููุงุญุธุงุช ูุฎุชุตุฑุฉ ููุท ุนูุฏ ุงูุถุฑูุฑุฉ
  if (interaction.isFromCustomer) {
    if (content.includes('ุณุนุฑ') || content.includes('ูุงู')) {
      prompt += `  โ ุณุคุงู ุนู ุงูุณุนุฑ\n`;
    }
    if (content.includes('ููุชุฌ') || content.includes('ููุชุดู')) {
      prompt += `  โ ุฐูุฑ ููุชุฌ\n`;
    }
  }
});
```

**ุงูุชูููุฑ:** ~600-1000 ุญุฑู  
**ุงูุชุฃุซูุฑ ุนูู ุงูุฌูุฏุฉ:** โ ูุง ุชุฃุซูุฑ (ุงูุฑุณุงุฆู ุงูุฃุฎูุฑุฉ ูู ุงูุฃูู)

---

### ุงูุชุญุณูู 2: ุฅุฒุงูุฉ ุงูุชูุฑุงุฑ โ

**ุงูุญู:**
- ุชูุญูุฏ ุงูุชุญุฐูุฑุงุช ูู ููุงู ูุงุญุฏ
- ุฅุฒุงูุฉ ุงูุชูุฑุงุฑ ูู ุงูุชุนูููุงุช

**ุงูููุฏ ุงูุญุงูู:**
```javascript
// โ ุชุญุฐูุฑ ุนุฏู ุงูุชุฑุญูุจ ูุธูุฑ 3 ูุฑุงุช
// ุงููุฑุฉ 1: ุงูุณุทุฑ 368-375
// ุงููุฑุฉ 2: ุงูุณุทุฑ 600-608
// ุงููุฑุฉ 3: ุงูุณุทุฑ 665-671
```

**ุงูููุฏ ุงููุญุณูู:**
```javascript
// โ ุฅุถุงูุฉ ุงูุชุญุฐูุฑ ูุฑุฉ ูุงุญุฏุฉ ููุท ูู ุงูุจุฏุงูุฉ
if (conversationMemory && conversationMemory.length > 0) {
  const aiMessagesCount = conversationMemory.filter(msg => !msg.isFromCustomer).length;
  if (aiMessagesCount > 0) {
    prompt += `๐ซ ููููุน ุงูุชุฑุญูุจ - ุงููุญุงุฏุซุฉ ูุณุชูุฑุฉ (${aiMessagesCount} ุฑุฏ ุณุงุจู)\n\n`;
  }
}
```

**ุงูุชูููุฑ:** ~400-600 ุญุฑู  
**ุงูุชุฃุซูุฑ ุนูู ุงูุฌูุฏุฉ:** โ ูุง ุชุฃุซูุฑ (ููุณ ุงููุนูููุงุช)

---

### ุงูุชุญุณูู 3: ุชุญุณูู RAG Data โ

**ุงูุญู:**
- ุชูููู ุนุฏุฏ ุงูููุชุฌุงุช ุงููุนุฑูุถุฉ (5 ุจุฏูุงู ูู 10)
- ุงุณุชุฎุฏุงู ููุฎุตุงุช ุจุฏูุงู ูู ุงููุตูุต ุงููุงููุฉ
- ุฅุฒุงูุฉ ุงููุนูููุงุช ุบูุฑ ุงูุถุฑูุฑูุฉ

**ุงูููุฏ ุงูุญุงูู:**
```javascript
filteredRagData.forEach((item, index) => {
  prompt += `๐๏ธ ููุชุฌ ${index + 1}: ${item.content}\n`; // โ ุงููุต ุงููุงูู
  // ... ูุนูููุงุช ุชูุตูููุฉ
});
```

**ุงูููุฏ ุงููุญุณูู:**
```javascript
// โ ุชูููู ุนุฏุฏ ุงูููุชุฌุงุช
const maxProducts = Math.min(filteredRagData.length, 5);
const productsToShow = filteredRagData.slice(0, maxProducts);

productsToShow.forEach((item, index) => {
  const productName = item.metadata?.name || item.name || 'ููุชุฌ';
  const productPrice = item.metadata?.price || 'ุบูุฑ ูุชููุฑ';
  
  // โ ููุฎุต ูุฎุชุตุฑ
  prompt += `${index + 1}. ${productName} - ${productPrice} ุฌููู\n`;
  
  // โ ูุนูููุงุช ุฅุถุงููุฉ ููุท ุนูุฏ ุงูุญุงุฌุฉ
  if (item.metadata?.stock === 0) {
    prompt += `   (ุบูุฑ ูุชููุฑ)\n`;
  }
});
```

**ุงูุชูููุฑ:** ~300-800 ุญุฑู  
**ุงูุชุฃุซูุฑ ุนูู ุงูุฌูุฏุฉ:** โ ูุง ุชุฃุซูุฑ (ุงูููุชุฌุงุช ุงูุฃูุซุฑ ุตูุฉ ูู ุงูุฃูู)

---

### ุงูุชุญุณูู 4: ุงุฎุชุตุงุฑ ุงูุชุนูููุงุช โ

**ุงูุญู:**
- ุฏูุฌ ุงูุชุนูููุงุช ุงููุชุดุงุจูุฉ
- ุงุณุชุฎุฏุงู ููุงุท ูุฎุชุตุฑุฉ ุจุฏูุงู ูู ููุฑุงุช ุทูููุฉ

**ุงูููุฏ ุงูุญุงูู:**
```javascript
prompt += `๐ด ุชุนูููุงุช ุฌูุฏุฉ ุงูุฑุฏ (ูููุฉ ุฌุฏุงู):\n`;
prompt += `=====================================\n`;
prompt += `1. โ ุงูุฑุฏ ูุฌุจ ุฃู ูููู ุดุงููุงู ููููุฏุงู:\n`;
prompt += `   - ุงูุฑุฏ ุงููุซุงูู: 50-300 ูููุฉ (ููุณุช ูุตูุฑุฉ ุฌุฏุงู ูููุณุช ุทูููุฉ ุฌุฏุงู)\n`;
prompt += `   - ูุฌุจ ุฃู ูุญุชูู ุนูู ุงููุนูููุงุช ุงููุทููุจุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช\n`;
// ... 5 ููุงุท ุทูููุฉ
```

**ุงูููุฏ ุงููุญุณูู:**
```javascript
// โ ุชุนูููุงุช ูุฎุชุตุฑุฉ
prompt += `๐ ููุงุนุฏ ุงูุฑุฏ: 50-300 ูููุฉ | ุงุณุชุฎุฏู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููุท | ุงุฑุจุท ุจุงููุญุงุฏุซุฉ ุงูุณุงุจูุฉ\n\n`;
```

**ุงูุชูููุฑ:** ~300-400 ุญุฑู  
**ุงูุชุฃุซูุฑ ุนูู ุงูุฌูุฏุฉ:** โ ูุง ุชุฃุซูุฑ (ููุณ ุงููุนูููุงุช ุจุดูู ูุฎุชุตุฑ)

---

### ุงูุชุญุณูู 5: ุฅุฒุงูุฉ ุงููุนูููุงุช ุบูุฑ ุงูุถุฑูุฑูุฉ โ

**ุงูุญู:**
- ุฅุฒุงูุฉ ูุนูููุงุช ุงูููุดูุฑ ุฅุฐุง ูู ุชูู ุถุฑูุฑูุฉ
- ุฅุฒุงูุฉ ุณูุงู ุงูููุชุฌ ุฅุฐุง ูุงู ุงูููุชุฌ ููุฌูุฏ ูู RAG Data

**ุงูููุฏ ุงูุญุงูู:**
```javascript
// โ ูุนูููุงุช ุงูููุดูุฑ ุชูุถุงู ุฏุงุฆูุงู ุฅุฐุง ูุงูุช ููุฌูุฏุฉ
if (messageData?.postDetails) {
  prompt += `๐ ูุนูููุงุช ุงูููุดูุฑ...`; // ~400 ุญุฑู
}
```

**ุงูููุฏ ุงููุญุณูู:**
```javascript
// โ ุฅุถุงูุฉ ูุนูููุงุช ุงูููุดูุฑ ููุท ุฅุฐุง ูุงูุช ุถุฑูุฑูุฉ
if (messageData?.postDetails && !ragData?.length) {
  // ููุท ุฅุฐุง ูู ููู ููุงู ููุชุฌุงุช ูู RAG Data
  prompt += `๐ ุงูููุชุฌ ูู ุงูููุดูุฑ: ${postProductInfo.name}\n\n`;
}
```

**ุงูุชูููุฑ:** ~200-400 ุญุฑู  
**ุงูุชุฃุซูุฑ ุนูู ุงูุฌูุฏุฉ:** โ ูุง ุชุฃุซูุฑ (ุงููุนูููุงุช ููุฌูุฏุฉ ูู RAG Data)

---

### ุงูุชุญุณูู 6: ุงุณุชุฎุฏุงู ููุฎุตุงุช ุฐููุฉ โ

**ุงูุญู:**
- ุฅูุดุงุก ููุฎุต ูููุญุงุฏุซุฉ ุจุฏูุงู ูู ุนุฑุถ ุฌููุน ุงูุฑุณุงุฆู
- ุงุณุชุฎุฑุงุฌ ุงููุนูููุงุช ุงููููุฉ ููุท (ุงูููุชุฌุ ุงูุณุนุฑุ ุงูุนููุงู)

**ุงูููุฏ ุงูููุชุฑุญ:**
```javascript
// โ ุฅูุดุงุก ููุฎุต ุฐูู ูููุญุงุฏุซุฉ
function createConversationSummary(conversationMemory) {
  const summary = {
    mentionedProducts: [],
    mentionedPrices: [],
    mentionedAddress: null,
    mentionedPhone: null,
    mentionedSize: null,
    mentionedColor: null
  };
  
  conversationMemory.forEach(msg => {
    if (msg.isFromCustomer) {
      // ุงุณุชุฎุฑุงุฌ ุงูููุชุฌุงุช
      const products = extractProducts(msg.content);
      summary.mentionedProducts.push(...products);
      
      // ุงุณุชุฎุฑุงุฌ ุงูุณุนุฑ
      const price = extractPrice(msg.content);
      if (price) summary.mentionedPrices.push(price);
      
      // ุงุณุชุฎุฑุงุฌ ุงูุนููุงู
      if (msg.content.includes('ุนููุงู') || msg.content.includes('ุดุงุฑุน')) {
        summary.mentionedAddress = msg.content;
      }
      
      // ... ุงุณุชุฎุฑุงุฌ ุจุงูู ุงููุนูููุงุช
    }
  });
  
  return summary;
}

// โ ุงุณุชุฎุฏุงู ุงูููุฎุต ุจุฏูุงู ูู ุฌููุน ุงูุฑุณุงุฆู
const summary = createConversationSummary(conversationMemory);
prompt += `๐ ููุฎุต ุงููุญุงุฏุซุฉ:\n`;
if (summary.mentionedProducts.length > 0) {
  prompt += `- ุงูููุชุฌุงุช ุงููุฐููุฑุฉ: ${summary.mentionedProducts.join(', ')}\n`;
}
if (summary.mentionedAddress) {
  prompt += `- ุงูุนููุงู: ${summary.mentionedAddress}\n`;
}
// ... ุจุงูู ุงูููุฎุต
```

**ุงูุชูููุฑ:** ~800-1500 ุญุฑู  
**ุงูุชุฃุซูุฑ ุนูู ุงูุฌูุฏุฉ:** โ ุชุญุณูู (ูุนูููุงุช ุฃูุถุญ ูุฃูุซุฑ ุชุฑููุฒุงู)

---

## ๐ ุฅุฌูุงูู ุงูุชูููุฑ ุงููุชููุน

### ูุจู ุงูุชุญุณููุงุช:
- ุงูุญุงูุฉ ุงููุชูุณุทุฉ: ~3900 ุญุฑู
- ุงูุญุงูุฉ ุงููุนูุฏุฉ: ~6000 ุญุฑู
- ุงูุญุงูุฉ ุงููุนูุฏุฉ ุฌุฏุงู: ~8500 ุญุฑู

### ุจุนุฏ ุงูุชุญุณููุงุช:
- ุงูุญุงูุฉ ุงููุชูุณุทุฉ: ~2200 ุญุฑู (ุชูููุฑ: 43%)
- ุงูุญุงูุฉ ุงููุนูุฏุฉ: ~3200 ุญุฑู (ุชูููุฑ: 47%)
- ุงูุญุงูุฉ ุงููุนูุฏุฉ ุงููุนูุฏุฉ ุฌุฏุงู: ~4200 ุญุฑู (ุชูููุฑ: 51%)

### ุชูููุฑ Tokens:
- ูุจู: ~2000-3000 tokens
- ุจุนุฏ: ~1100-1600 tokens
- **ุงูุชูููุฑ:** ~45-50%

---

## โ ุงูุชุฃุซูุฑ ุนูู ุงูุฌูุฏุฉ

### โ ูุง ุชุฃุซูุฑ ุณูุจู:
- โ ุงููุนูููุงุช ุงููููุฉ ุชุจูู ููุฌูุฏุฉ
- โ ุงูุฑุณุงุฆู ุงูุฃุฎูุฑุฉ (ุงูุฃูู) ุชุจูู ูุงููุฉ
- โ ุงูููุชุฌุงุช ุงูุฃูุซุฑ ุตูุฉ ุชุจูู ููุฌูุฏุฉ
- โ ุงูุชุนูููุงุช ุงูุฃุณุงุณูุฉ ุชุจูู ููุฌูุฏุฉ

### โ ุชุญุณูู ุงูุฌูุฏุฉ:
- โ ูุนูููุงุช ุฃูุถุญ ูุฃูุซุฑ ุชุฑููุฒุงู
- โ AI ูุฑูุฒ ุนูู ุงููุนูููุงุช ุงููููุฉ
- โ ุชูููู ุงูุชุดุชุช ูู ุงููุนูููุงุช ุงูุฒุงุฆุฏุฉ
- โ ุฑุฏูุฏ ุฃุณุฑุน ูุฃูุซุฑ ุฏูุฉ

---

## ๐ฏ ุฎุทุฉ ุงูุชูููุฐ

### ุงููุฑุญูุฉ 1: ุงูุชุญุณููุงุช ุงูุณุฑูุนุฉ (Quick Wins)
1. โ ุชูููู ุนุฏุฏ ุงูุฑุณุงุฆู ูู 5 ุฅูู 3
2. โ ุฅุฒุงูุฉ ุงูุชูุฑุงุฑ ูู ุงูุชุญุฐูุฑุงุช
3. โ ุชูููู ุนุฏุฏ ุงูููุชุฌุงุช ูู 10 ุฅูู 5

**ุงูููุช ุงููุชููุน:** 1-2 ุณุงุนุฉ  
**ุงูุชูููุฑ:** ~30-35%

---

### ุงููุฑุญูุฉ 2: ุงูุชุญุณููุงุช ุงููุชูุณุทุฉ
4. โ ุงุฎุชุตุงุฑ ุงูุชุนูููุงุช
5. โ ุฅุฒุงูุฉ ุงููุนูููุงุช ุบูุฑ ุงูุถุฑูุฑูุฉ
6. โ ุชุญุณูู ุนุฑุถ RAG Data

**ุงูููุช ุงููุชููุน:** 2-3 ุณุงุนุงุช  
**ุงูุชูููุฑ ุงูุฅุถุงูู:** ~10-15%

---

### ุงููุฑุญูุฉ 3: ุงูุชุญุณููุงุช ุงููุชูุฏูุฉ
7. โ ุงุณุชุฎุฏุงู ููุฎุตุงุช ุฐููุฉ
8. โ ูุธุงู ุฃููููุงุช ูููุนูููุงุช
9. โ Cache ููู prompts ุงููุจููุฉ

**ุงูููุช ุงููุชููุน:** 4-6 ุณุงุนุงุช  
**ุงูุชูููุฑ ุงูุฅุถุงูู:** ~5-10%

---

## ๐ ุงูุฎูุงุตุฉ

### ุงููุดููุฉ:
- โ๏ธ ุงูู Prompt ุทููู ุฌุฏุงู (5000-8500 ุญุฑู)
- โ๏ธ 8 ูููุงุช ูุดุงุฑูุฉ ูู ุงูุจูุงุก
- โ๏ธ ุชูุฑุงุฑ ููุฑุท ูู ุงููุนูููุงุช
- โ๏ธ ูุนูููุงุช ุบูุฑ ุถุฑูุฑูุฉ

### ุงูุญู:
- โ ุชูููู ุณุฌู ุงููุญุงุฏุซุฉ (5 โ 3 ุฑุณุงุฆู)
- โ ุฅุฒุงูุฉ ุงูุชูุฑุงุฑ
- โ ุชุญุณูู RAG Data
- โ ุงุฎุชุตุงุฑ ุงูุชุนูููุงุช
- โ ุงุณุชุฎุฏุงู ููุฎุตุงุช ุฐููุฉ

### ุงููุชูุฌุฉ:
- โ ุชูููุฑ 45-50% ูู ุงูุทูู
- โ ุชูููุฑ 45-50% ูู Tokens
- โ ุชุญุณูู ุงูุฌูุฏุฉ (ูุนูููุงุช ุฃูุถุญ)
- โ ุชุญุณูู ุงูุฃุฏุงุก (ุฃุณุฑุน)

---

**ุชู ุฅูุดุงุก ูุฐุง ุงูุชูุฑูุฑ ุจูุงุณุทุฉ:** AI Assistant  
**ุงูุชุงุฑูุฎ:** 2025-11-28

