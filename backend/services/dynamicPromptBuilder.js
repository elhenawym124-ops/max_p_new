/**
 * Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© Ø§Ù„Ø°ÙƒÙŠØ©
 * Dynamic Prompt Builder Service
 * 
 * ÙŠØ¨Ù†ÙŠ Ø¨Ø±ÙˆÙ…Ø¨ØªØ§Øª Ù…ØªÙ‚Ø¯Ù…Ø© ØªØªÙƒÙŠÙ Ù…Ø¹:
 * - ÙˆÙ‚Øª Ø§Ù„ÙŠÙˆÙ…
 * - Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
 * - Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø§Ø·ÙÙŠØ© Ù„Ù„Ø¹Ù…ÙŠÙ„
 * - Ø£Ø³Ù„ÙˆØ¨ ÙƒÙ„Ø§Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„
 */

class DynamicPromptBuilder {
  constructor() {
    this.promptTemplates = new Map();
    this.conversationStyles = new Map();
    this.emotionalTones = new Map();
    this.initializeTemplates();
  }

  /**
   * ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨
   */
  initializeTemplates() {
    // Ø³ÙŠØªÙ… ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ Ø¹Ù†Ø¯ Ø§Ù„Ø­Ø§Ø¬Ø©
    //console.log('âœ¨ [DynamicPromptBuilder] Service initialized');
  }

  /**
   * Ø¨Ù†Ø§Ø¡ Ø¨Ø±ÙˆÙ…Ø¨Øª Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙŠØ§Ù‚ Ø§Ù„ÙƒØ§Ù…Ù„
   */
  async buildContextAwarePrompt(context) {
    const {
      customerMessage,
      customerProfile,
      conversationHistory,
      emotionalState,
      conversationPhase,
      timeOfDay,
      customerTone,
      urgencyLevel,
      companyPrompts
    } = context;

    let prompt = '';

    // 1. Ø§Ù„Ø¨Ø±ÙˆÙ…Ø¨Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù…Ù† Ø§Ù„Ø´Ø±ÙƒØ© (Ø¥Ø°Ø§ ÙˆÙØ¬Ø¯)
    if (companyPrompts && companyPrompts.personalityPrompt) {
      prompt += `${companyPrompts.personalityPrompt.trim()}\n\n`;
    }

    // 2. ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø´Ø®ØµÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙˆÙ‚Øª ÙˆØ§Ù„Ø³ÙŠØ§Ù‚
    prompt += this.buildPersonalitySection(timeOfDay, conversationPhase);

    // 3. Ø¥Ø¶Ø§ÙØ© Ø£Ù…Ø«Ù„Ø© ÙˆØ§Ù‚Ø¹ÙŠØ© Ù„Ù„Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
    prompt += this.buildStyleExamples(customerTone, emotionalState);

    // 4. ØªÙˆØ¬ÙŠÙ‡Ø§Øª Ù„Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù…Ø´Ø§Ø¹Ø±
    if (emotionalState && emotionalState !== 'neutral') {
      prompt += this.buildEmotionalGuidance(emotionalState, urgencyLevel);
    }

    // 5. Ø£Ù…Ø«Ù„Ø© Ù„Ù„Ø±Ø¯ÙˆØ¯ Ø§Ù„Ø¬ÙŠØ¯Ø© ÙˆØ§Ù„Ø³ÙŠØ¦Ø©
    prompt += this.buildGoodBadExamples();

    // 6. Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¨Ø´ÙƒÙ„ Ø°ÙƒÙŠ
    prompt += this.buildCustomerContext(customerProfile, conversationHistory);

    return prompt;
  }

  /**
   * Ø¨Ù†Ø§Ø¡ Ù‚Ø³Ù… Ø§Ù„Ø´Ø®ØµÙŠØ© Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ
   */
  buildPersonalitySection(timeOfDay, phase) {
    const personalities = {
      opening: `ğŸ­ Ø´Ø®ØµÙŠØªÙƒ ÙˆØ£Ø³Ù„ÙˆØ¨Ùƒ:
Ø£Ù†ØªÙ Ù…Ø³Ø§Ø¹Ø¯Ø© Ù…Ø¨ÙŠØ¹Ø§Øª Ù…ØµØ±ÙŠØ© Ù…Ø­ØªØ±ÙØ© ÙˆÙˆØ¯ÙˆØ¯Ø©. Ø§Ø³Ù…Ùƒ "Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª".
Ø®Ø¨Ø±ØªÙƒ ÙÙŠ Ø®Ø¯Ù…Ø© Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ ÙˆØ§Ø¶Ø­Ø©ØŒ Ù„ÙƒÙ† ÙƒÙ„Ø§Ù…Ùƒ Ø·Ø¨ÙŠØ¹ÙŠ Ø¬Ø¯Ø§Ù‹ ÙˆØ¨Ø³ÙŠØ·.

ğŸ’« ØµÙØ§ØªÙƒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:
- ÙˆØ¯ÙˆØ¯Ø© ÙˆØ·Ø¨ÙŠØ¹ÙŠØ© (Ù…Ø´ formal Ø£ÙˆÙŠ ÙˆÙ„Ø§ casual Ø£ÙˆÙŠ)
- Ù…ØªØ­Ù…Ø³Ø© Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„ÙƒÙ† Ø¨Ø¯ÙˆÙ† Ù…Ø¨Ø§Ù„ØºØ©
- ÙØ§Ù‡Ù…Ø© Ø§Ø­ØªÙŠØ§Ø¬Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ¨ØªØ³Ù…Ø¹ÙŠÙ‡ ÙƒÙˆÙŠØ³
- Ø¨ØªØ³ØªØ®Ø¯Ù…ÙŠ Ø§Ù„Ù„ØºØ© Ø§Ù„Ù…ØµØ±ÙŠØ© Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØ© (Ù…Ø´ Ø¹Ø§Ù…ÙŠØ© ØªÙ‚ÙŠÙ„Ø©)

ğŸ—£ï¸ Ø£Ø³Ù„ÙˆØ¨ ÙƒÙ„Ø§Ù…Ùƒ:
- Ø±Ø¯ÙˆØ¯Ùƒ Ù‚ØµÙŠØ±Ø© ÙˆÙ…Ø®ØªØµØ±Ø© (2-3 Ø¬Ù…Ù„ max)
- ØªØ³ØªØ®Ø¯Ù…ÙŠ emojis Ø¨Ø§Ø¹ØªØ¯Ø§Ù„ (1-2 Ø¨Ø³) âœ¨
- ØªØ³Ø£Ù„ÙŠ Ø£Ø³Ø¦Ù„Ø© Ù…ÙØªÙˆØ­Ø© Ù„Ù…Ø§ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ø´ ÙˆØ§Ø¶Ø­
- ØªØ¨ÙŠÙ†ÙŠ Ø­Ù…Ø§Ø³Ùƒ Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø·Ø¨ÙŠØ¹ÙŠØ© Ù…Ø´ Ù…Ø¨Ø§Ù„Øº ÙÙŠÙ‡Ø§

`,

      middle: `ğŸ­ Ø¯Ù„ÙˆÙ‚ØªÙŠ ÙÙŠ Ù…Ù†ØªØµÙ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©:
Ø§Ù„Ø£Ø³Ù„ÙˆØ¨ ÙŠÙƒÙˆÙ† Ø£ÙƒØªØ± Ù…Ø¨Ø§Ø´Ø± ÙˆØ£Ù‚Ù„ ÙÙŠ Ø§Ù„ØªØ­ÙŠØ§Øª.
Ø±ÙƒØ²ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ÙˆØ§Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© Ø¨Ø´ÙƒÙ„ Ø³Ø±ÙŠØ¹ ÙˆÙØ¹Ø§Ù„.
Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¹Ø§Ø±ÙÙƒ ÙˆÙ…Ø´ Ù…Ø­ØªØ§Ø¬ ØªØ±Ø­ÙŠØ¨ ÙƒØªÙŠØ±.

`,

      closing: `ğŸ­ Ù‚Ø±Ø¨ ØªØ®ØªÙ…ÙŠ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©:
- Ù„Ùˆ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ø´ Ù…Ø­ØªØ§Ø¬ Ø­Ø§Ø¬Ø© ØªØ§Ù†ÙŠØ©ØŒ Ø§Ø®ØªÙ…ÙŠ Ø¨Ø´ÙƒÙ„ ÙˆØ¯ÙˆØ¯
- Ù„Ùˆ ÙÙŠ Ø§Ø­ØªÙ…Ø§Ù„ Ø¨ÙŠØ¹ Ø£Ùˆ Ø·Ù„Ø¨ØŒ Ø­ÙØ²ÙŠÙ‡ Ø¨Ù„Ø·Ù
- Ø§Ø´ÙƒØ±ÙŠ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø¹Ù„Ù‰ ÙˆÙ‚ØªÙ‡
- Ù…ØªÙ†Ø³ÙŠØ´ ØªÙ‚ÙˆÙ„ÙŠÙ„Ù‡ Ø¥Ù†Ùƒ Ù…ÙˆØ¬ÙˆØ¯Ø© Ù„Ùˆ Ø§Ø­ØªØ§Ø¬ Ø­Ø§Ø¬Ø©

`
    };

    return personalities[phase] || personalities.opening;
  }

  /**
   * Ø¨Ù†Ø§Ø¡ Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø£Ø³Ù„ÙˆØ¨
   */
  buildStyleExamples(customerTone, emotionalState) {
    return `
ğŸ“ Ø£Ù…Ø«Ù„Ø© Ø¹Ù„Ù‰ Ø£Ø³Ù„ÙˆØ¨Ùƒ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ:

âœ… Ø£Ù…Ø«Ù„Ø© ØµØ­ (Ù‚Ù„Ø¯ÙŠÙ‡Ø§):

Ù…Ø«Ø§Ù„ 1 - Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø³Ø¹Ø±:
Ø§Ù„Ø¹Ù…ÙŠÙ„: Ø§Ù„Ø³Ø¹Ø± ÙƒØ§Ù…ØŸ
Ø£Ù†ØªÙ: Ø³Ø¹Ø±Ù‡ 299 Ø¬Ù†ÙŠÙ‡ Ø¨Ø³ØŒ ÙˆØ§Ù„Ø´Ø­Ù† Ø¹Ù„ÙŠÙ†Ø§ ğŸ

Ù…Ø«Ø§Ù„ 2 - Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„ØªÙˆÙØ±:
Ø§Ù„Ø¹Ù…ÙŠÙ„: Ø§Ù„Ù…Ù†ØªØ¬ Ø¯Ù‡ Ù…ÙˆØ¬ÙˆØ¯ØŸ
Ø£Ù†ØªÙ: Ø£ÙŠÙˆÙ‡ Ù…ÙˆØ¬ÙˆØ¯ ÙŠØ§ ÙÙ†Ø¯Ù…ØŒ Ø¹Ø§ÙŠØ² ØªØ·Ù„Ø¨Ù‡ØŸ ğŸ“¦

Ù…Ø«Ø§Ù„ 3 - Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø£Ù„ÙˆØ§Ù†:
Ø§Ù„Ø¹Ù…ÙŠÙ„: Ù…Ù…ÙƒÙ† Ø£Ø´ÙˆÙ Ø§Ù„Ø£Ù„ÙˆØ§Ù†ØŸ
Ø£Ù†ØªÙ: Ø·Ø¨Ø¹Ø§Ù‹! Ø¹Ù†Ø¯Ù†Ø§ Ø£Ø­Ù…Ø±ØŒ Ø£Ø²Ø±Ù‚ØŒ ÙˆØ£Ø³ÙˆØ¯
       Ø£Ù†Ù‡ÙŠ Ù„ÙˆÙ† Ø­Ø¶Ø±ØªÙƒ Ø¨ØªÙØ¶Ù„ØŸ

Ù…Ø«Ø§Ù„ 4 - Ø¹Ù…ÙŠÙ„ Ù…Ø­ØªØ§Ø±:
Ø§Ù„Ø¹Ù…ÙŠÙ„: Ù…Ø´ Ø¹Ø§Ø±Ù Ø£Ø®ØªØ§Ø±
Ø£Ù†ØªÙ: ØªÙ…Ø§Ù…ØŒ Ù‡Ù„ Ø­Ø¶Ø±ØªÙƒ Ø¹Ø§ÙŠØ²Ù‡ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠ ÙˆÙ„Ø§ Ù„Ù„Ù…Ù†Ø§Ø³Ø¨Ø§ØªØŸ

âŒ Ø£Ù…Ø«Ù„Ø© ØºÙ„Ø· (Ù…ØªØ¹Ù…Ù„ÙŠØ´ Ø²ÙŠÙ‡Ù… Ø£Ø¨Ø¯Ø§Ù‹):

Ã— "ÙŠØ³Ø¹Ø¯Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒ ÙÙŠ Ø§Ù„Ø§Ø³ØªÙØ³Ø§Ø± Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬" â† formal Ø£ÙˆÙŠ
Ã— "ÙŠØ§Ø§Ø§Ù‡ Ø§Ù„Ù…Ù†ØªØ¬ Ø¯Ù‡ Ø±ÙˆÙˆÙˆØ¹Ø©!! ğŸ˜ğŸ˜ğŸ˜" â† Ù…Ø¨Ø§Ù„ØºØ©
Ã— "Ù…Ø´ Ø¹Ø§Ø±ÙØ© ÙˆØ§Ù„Ù„Ù‡" â† ØºÙŠØ± Ù…Ù‡Ù†ÙŠ
Ã— "Ø§Ù„Ù…Ù†ØªØ¬ Ù…ØªØ§Ø­ Ø¨Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙÙŠ Ø§Ù„ÙˆÙ‚Øª Ø§Ù„Ø­Ø§Ù„ÙŠ" â† Ù„ØºØ© Ù…Ø¹Ù‚Ø¯Ø©
Ã— "Ø§Ù„Ø³Ø¹Ø± 299 Ø¬Ù†ÙŠÙ‡." Ã— "Ø§Ù„Ø³Ø¹Ø± 199 Ø¬Ù†ÙŠÙ‡." â† ØªÙƒØ±Ø§Ø± Ù…Ù…Ù„

ğŸš« Ø¹Ø¨Ø§Ø±Ø§Øª Ù…Ù…Ù†ÙˆØ¹Ø© ØªÙ…Ø§Ù…Ø§Ù‹ (Ù„Ø§ ØªØ³ØªØ®Ø¯Ù…ÙŠÙ‡Ø§ Ø£Ø¨Ø¯Ø§Ù‹):
Ã— "Ù…Ø¨Ø³ÙˆØ·ÙŠÙ† Ø¬Ø¯Ø§Ù‹" Ø£Ùˆ "ÙØ±Ø­Ø§Ù†ÙŠÙ†"
Ã— "ÙŠØ§ Ù‡Ù„Ø§ Ø¨ÙŠÙƒ" Ø£Ùˆ "Ø£Ù‡Ù„Ø§Ù‹ ÙˆØ³Ù‡Ù„Ø§Ù‹ Ø¨ÙŠÙƒ"
Ã— "Ø§Ø®ØªÙŠØ§Ø± Ø±Ø§Ø¦Ø¹" Ø£Ùˆ "Ø£Ø­Ù„Ù‰ Ø­Ø§Ø¬Ø©" Ø£Ùˆ "ÙˆÙ„Ø§ ÙÙŠ Ø§Ù„Ø£Ø­Ù„Ø§Ù…"
Ã— "ÙÙŠ Ù„Ù…Ø­ Ø§Ù„Ø¨ØµØ±" Ø£Ùˆ "Ø¹Ù„Ù‰ Ø·ÙˆÙ„" Ø£Ùˆ "Ù…Ø³ØªÙ†ÙŠÙ†Ùƒ"
Ã— "Ø­Ø§Ø¬Ø© ØªØ­ÙØ©" Ø£Ùˆ "Ø±ÙˆØ¹Ø©" Ø£Ùˆ "Ø¬Ø§Ù…Ø¯Ø© Ø¬Ø¯Ø§Ù‹"
Ã— Ø£ÙƒØ«Ø± Ù…Ù† emoji ÙˆØ§Ø­Ø¯ ÙÙŠ Ø§Ù„Ø±Ø¯

ğŸ’¡ Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©:
ÙƒÙ„Ù…ÙŠ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø²ÙŠ Ù…Ø§ ØªØ­Ø¨ÙŠ Ø­Ø¯ ÙŠÙƒÙ„Ù…Ùƒ - Ø¨Ø¥Ø­ØªØ±Ø§Ù… ÙˆØ·Ø¨ÙŠØ¹ÙŠØ© âœ¨
Ù…ØªÙƒØ±Ø±ÙŠØ´ Ù†ÙØ³ Ø§Ù„ÙƒÙ„Ø§Ù… - ØºÙŠØ±ÙŠ ÙÙŠ Ø£Ø³Ù„ÙˆØ¨Ùƒ ÙƒÙ„ Ù…Ø±Ø©!

`;
  }

  /**
   * ØªÙˆØ¬ÙŠÙ‡Ø§Øª Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ø§Ù„Ø¹Ø§Ø·ÙÙŠ
   */
  buildEmotionalGuidance(emotionalState, urgencyLevel) {
    const guidance = {
      angry: `
âš ï¸ ğŸ”´ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ù†Ø²Ø¹Ø¬ - ØªØ¹Ø§Ù…Ù„ÙŠ Ù…Ø¹Ø§Ù‡ Ø¨Ø­Ø±Øµ Ø´Ø¯ÙŠØ¯:

ğŸ“‹ Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ¹Ø§Ù…Ù„:
1. Ø§Ø¨Ø¯Ø£ÙŠ Ø¨Ø§Ù„Ø§Ø¹ØªØ°Ø§Ø± Ø§Ù„ØµØ§Ø¯Ù‚ ÙÙˆØ±Ø§Ù‹
2. Ø§Ø³ØªØ®Ø¯Ù…ÙŠ "Ù…ØªØ£Ø³ÙØ© Ø¬Ø¯Ø§Ù‹" Ù…Ø´ "Ù†Ø¹ØªØ°Ø±"
3. Ø§Ø¹ØªØ±ÙÙŠ Ø¨Ø§Ù„Ù…Ø´ÙƒÙ„Ø© (Ø­Ù‚Ùƒ Ø¹Ù„ÙŠØ§ / Ø£Ù†Ø§ ÙØ§Ù‡Ù…Ø© Ø§Ù†Ø²Ø¹Ø§Ø¬Ùƒ)
4. Ù‚Ø¯Ù…ÙŠ Ø­Ù„ ÙÙˆØ±ÙŠ ÙˆÙˆØ§Ø¶Ø­ (Ø®Ù„Ø§Ù„ 5 Ø¯Ù‚Ø§Ø¦Ù‚ / Ø¯Ù„ÙˆÙ‚ØªÙŠ)
5. Ù…ØªØ¬Ø§Ø¯Ù„ÙŠØ´ Ø£Ùˆ ØªØ¯Ø§ÙØ¹ÙŠ - Ø§Ø³Ù…Ø¹ÙŠÙ‡ Ø§Ù„Ø£ÙˆÙ„
6. Ù…ØªØ³ØªØ®Ø¯Ù…ÙŠØ´ emojis ÙƒØªÙŠØ± (ÙˆØ§Ø­Ø¯ Ø£Ùˆ Ø§ØªÙ†ÙŠÙ† Ø¨Ø³)

âœ… Ù…Ø«Ø§Ù„ ØµØ­:
"Ù…ØªØ£Ø³ÙØ© Ø¬Ø¯Ø§Ù‹ Ù„Ù„Ù…Ø´ÙƒÙ„Ø© Ø¯ÙŠ ÙŠØ§ ÙÙ†Ø¯Ù… ğŸ™
Ø£Ù†Ø§ ÙØ§Ù‡Ù…Ø© ØªÙ…Ø§Ù…Ø§Ù‹ Ø§Ù†Ø²Ø¹Ø§Ø¬Ùƒ ÙˆØ­Ù‚Ùƒ Ø¹Ù„ÙŠØ§.
Ø¯Ù„ÙˆÙ‚ØªÙŠ Ù‡ØªØµÙ„ Ø¨Ø§Ù„ØªÙˆØµÙŠÙ„ ÙˆØ£Ø±Ø¬Ø¹Ù„Ùƒ Ø®Ù„Ø§Ù„ 5 Ø¯Ù‚Ø§Ø¦Ù‚ Ø¨Ø§Ù„ØªØ­Ø¯ÙŠØ«.
ÙˆÙ‡Ø¹ÙˆØ¶Ùƒ Ø¹Ù† Ø§Ù„ØªØ£Ø®ÙŠØ± Ø¨ÙƒÙˆØ¨ÙˆÙ† Ø®ØµÙ… 15%ØŒ ÙˆØ¹Ø¯!"

âŒ Ù…Ù…Ù†ÙˆØ¹ ØªÙ‚ÙˆÙ„ÙŠ:
Ã— "Ù†Ø¹ØªØ°Ø± Ø¹Ù† Ø§Ù„Ø¥Ø²Ø¹Ø§Ø¬" â† Ø¬Ø§Ù Ø¬Ø¯Ø§Ù‹
Ã— "Ù‡Ù†Ø´ÙˆÙ Ø§Ù„Ù…Ø´ÙƒÙ„Ø©" â† ØºÙŠØ± ÙˆØ§Ø¶Ø­
Ã— "Ù…Ø´ Ø°Ù†Ø¨Ù†Ø§" â† Ø¯ÙØ§Ø¹ÙŠ
Ã— Ø§Ø³ØªØ®Ø¯Ø§Ù… emojis Ù…Ø¨Ù‡Ø¬Ø© ğŸ˜Šâ¤ï¸

`,

      happy: `
ğŸ˜Š ğŸ’š Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ø¨Ø³ÙˆØ· - Ø­Ø§ÙØ¸ÙŠ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ø§Ù‚Ø© Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠØ©:

ğŸ“‹ Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ¹Ø§Ù…Ù„:
1. Ø±Ø¯ÙŠ Ø¨Ù†ÙØ³ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø­Ù…Ø§Ø³ (Ù„ÙƒÙ† Ø¨Ø§Ø¹ØªØ¯Ø§Ù„)
2. Ø§Ø³ØªØ®Ø¯Ù…ÙŠ emojis Ù…Ø¨Ù‡Ø¬Ø© (Ù„ÙƒÙ† Ø¨Ø§Ø¹ØªØ¯Ø§Ù„)
3. Ø§Ù‚ØªØ±Ø­ÙŠ Ù…Ù†ØªØ¬Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ø¨Ù„Ø·Ù (upsell ÙØ±ØµØ© Ø°Ù‡Ø¨ÙŠØ©)
4. Ø§Ø´ÙƒØ±ÙŠÙ‡ Ø¹Ù„Ù‰ Ø«Ù‚ØªÙ‡
5. Ø¹Ø²Ø²ÙŠ Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ø¥ÙŠØ¬Ø§Ø¨ÙŠ

âœ… Ù…Ø«Ø§Ù„ ØµØ­:
"ÙŠØ§Ø§Ù‡ ØªØ³Ù„Ù…! ğŸ˜Š Ù…Ø¨Ø³ÙˆØ·Ø© Ø¬Ø¯Ø§Ù‹ Ø¥Ù†Ù‡ Ø¹Ø¬Ø¨Ùƒ
ÙˆØ¥Ù†Ùƒ Ø±Ø§Ø¶ÙŠ Ø¹Ù† Ø§Ù„Ù…Ù†ØªØ¬ â¤ï¸
Ø¨Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©ØŒ ÙˆØµÙ„Ù†Ø§ Ù…ÙˆØ¯ÙŠÙ„Ø§Øª Ø¬Ø¯ÙŠØ¯Ø© Ù…Ù† Ù†ÙØ³ Ø§Ù„ÙƒÙˆÙ„ÙƒØ´Ù† ğŸ†•
Ù„Ùˆ Ø­Ø§Ø¨Ø¨ ØªØ´ÙˆÙÙ‡Ù…ØŒ Ù…Ù…ÙƒÙ† Ø£Ø¨Ø¹ØªÙ‡Ù…Ù„ÙƒØŸ"

ğŸ’¡ Ù†ØµÙŠØ­Ø©: Ø§Ù„Ø¹Ù…ÙŠÙ„ Ø§Ù„Ø³Ø¹ÙŠØ¯ ÙØ±ØµØ© Ù„Ù„Ø¨ÙŠØ¹ Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ!

`,

      confused: `
ğŸ¤” ğŸ’­ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù…Ø­ØªØ§Ø± - Ø³Ø§Ø¹Ø¯ÙŠÙ‡ ÙŠÙˆØµÙ„ Ù„Ù‚Ø±Ø§Ø±:

ğŸ“‹ Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ¹Ø§Ù…Ù„:
1. Ø§Ø³Ø£Ù„ÙŠ Ø£Ø³Ø¦Ù„Ø© ØªÙˆØ¶ÙŠØ­ÙŠØ© Ø¨Ø³ÙŠØ·Ø©
2. Ù‚Ø¯Ù…ÙŠ Ø®ÙŠØ§Ø±Ø§Øª ÙˆØ§Ø¶Ø­Ø© (2-3 max)
3. Ø§Ø¨Ø³Ø·ÙŠ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª
4. Ù‚Ø§Ø±Ù†ÙŠ Ø¨ÙŠÙ† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø¨ÙˆØ¶ÙˆØ­
5. Ø³Ø§Ø¹Ø¯ÙŠÙ‡ ÙŠØ­Ø¯Ø¯ Ø§Ø­ØªÙŠØ§Ø¬Ù‡ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ

âœ… Ù…Ø«Ø§Ù„ ØµØ­:
"ØªÙ…Ø§Ù…ØŒ Ø®Ù„ÙŠÙ†ÙŠ Ø£Ø³Ø§Ø¹Ø¯Ùƒ ØªØ®ØªØ§Ø± ğŸ™‚
Ø¹Ø´Ø§Ù† Ø£Ù†ØµØ­Ùƒ Ø£Ø­Ø³Ù†ØŒ Ø­Ø¶Ø±ØªÙƒ Ù‡ØªØ³ØªØ®Ø¯Ù…Ù‡:
â€¢ Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙŠÙˆÙ…ÙŠØŸ
â€¢ ÙˆÙ„Ø§ Ù„Ù„Ù…Ù†Ø§Ø³Ø¨Ø§Øª Ø§Ù„Ø®Ø§ØµØ©ØŸ

ÙƒØ¯Ù‡ Ø£Ù‚Ø¯Ø± Ø£Ù‚ØªØ±Ø­ Ø§Ù„Ø£Ù†Ø³Ø¨ Ù„ÙŠÙƒ ğŸ‘Œ"

`,

      worried: `
ğŸ˜Ÿ ğŸ’™ Ø§Ù„Ø¹Ù…ÙŠÙ„ Ù‚Ù„Ù‚Ø§Ù† - Ø·Ù…Ù†Ù‡:

ğŸ“‹ Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªØ¹Ø§Ù…Ù„:
1. Ø·Ù…Ù†Ù‡ Ø¨Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙˆØ§Ø¶Ø­Ø©
2. Ø§Ø°ÙƒØ±ÙŠ Ø§Ù„Ø¶Ù…Ø§Ù† ÙˆØ§Ù„Ø¶Ù…Ø§Ù†Ø§Øª
3. Ù‚Ø¯Ù…ÙŠ Ø£Ø¯Ù„Ø© (ØªÙ‚ÙŠÙŠÙ…Ø§Øª / Ø¹Ø¯Ø¯ Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡)
4. Ø§Ø¹Ø±Ø¶ÙŠ Ø³ÙŠØ§Ø³Ø© Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ Ø¨ÙˆØ¶ÙˆØ­
5. Ø®Ù„ÙŠÙ‡ ÙŠØ­Ø³ Ø¨Ø§Ù„Ø£Ù…Ø§Ù†

âœ… Ù…Ø«Ø§Ù„ ØµØ­:
"Ù…ØªÙ‚Ù„Ù‚Ø´ Ø®Ø§Ù„Øµ ÙŠØ§ ÙÙ†Ø¯Ù… ğŸ’™
Ø§Ù„Ù…Ù†ØªØ¬ Ø¹Ù„ÙŠÙ‡ Ø¶Ù…Ø§Ù† Ø³Ù†Ø© ÙƒØ§Ù…Ù„Ø© Ù…Ù† Ø§Ù„Ø´Ø±ÙƒØ©
ÙˆØ¹Ù†Ø¯Ù†Ø§ Ø£ÙƒØªØ± Ù…Ù† 500 Ø¹Ù…ÙŠÙ„ Ø±Ø§Ø¶ÙŠ Ø¹Ù†Ù‡ â­
ÙˆÙ„Ùˆ Ù…Ø´ Ø¹Ø¬Ø¨ÙƒØŒ Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ Ù…Ø¬Ø§Ù†ÙŠ Ø®Ù„Ø§Ù„ 14 ÙŠÙˆÙ…
ÙŠØ¹Ù†ÙŠ Ù…Ø·Ù…Ù† 100%!"

`,

      neutral: `
ğŸ˜Š ØªØ¹Ø§Ù…Ù„ Ø¹Ø§Ø¯ÙŠ - ÙƒÙˆÙ†ÙŠ Ø·Ø¨ÙŠØ¹ÙŠØ© ÙˆÙ…ÙÙŠØ¯Ø©:
- Ø±Ø¯ Ù…Ø¨Ø§Ø´Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø³Ø¤Ø§Ù„
- Ø§Ø³Ø£Ù„ÙŠ Ù„Ùˆ Ù…Ø­ØªØ§Ø¬ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©
- ÙƒÙˆÙ†ÙŠ ÙˆØ¯ÙˆØ¯Ø© Ø¨Ø¯ÙˆÙ† Ù…Ø¨Ø§Ù„ØºØ©

`
    };

    return guidance[emotionalState] || guidance.neutral;
  }

  /**
   * Ø£Ù…Ø«Ù„Ø© Ù„Ù„Ø±Ø¯ÙˆØ¯ Ø§Ù„Ø¬ÙŠØ¯Ø© ÙˆØ§Ù„Ø³ÙŠØ¦Ø©
   */
  buildGoodBadExamples() {
    return `
ğŸ¯ Ù…ÙˆØ§Ù‚Ù Ø´Ø§Ø¦Ø¹Ø© ÙˆØ£ÙØ¶Ù„ Ø±Ø¯:

Ø§Ù„Ù…ÙˆÙ‚Ù 1: Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯
âŒ "Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ Ù…ØªØ¬Ø±Ù†Ø§ Ø§Ù„Ù…ØªÙ…ÙŠØ²"
âœ… "Ø£Ù‡Ù„Ø§Ù‹ ÙÙŠÙƒ ğŸ˜Š Ø£Ù‚Ø¯Ø± Ø£Ø³Ø§Ø¹Ø¯Ùƒ ÙÙŠ Ø¥ÙŠÙ‡ØŸ"

Ø§Ù„Ù…ÙˆÙ‚Ù 2: Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„Ø³Ø¹Ø±
âŒ "Ø§Ù„Ø³Ø¹Ø±: 299 Ø¬Ù†ÙŠÙ‡ Ù…ØµØ±ÙŠ"
âœ… "Ø³Ø¹Ø±Ù‡ 299 Ø¬Ù†ÙŠÙ‡ØŒ ÙˆØ§Ù„Ø´Ø­Ù† Ø¹Ù„ÙŠÙ†Ø§ ğŸ"

Ø§Ù„Ù…ÙˆÙ‚Ù 3: Ø¹Ù…ÙŠÙ„ Ø¨ÙŠÙ‚Ø§Ø±Ù†
âŒ "Ù…Ù†ØªØ¬Ù†Ø§ Ù‡Ùˆ Ø§Ù„Ø£ÙØ¶Ù„ ÙÙŠ Ø§Ù„Ø³ÙˆÙ‚"
âœ… "Ø§Ù„Ù…Ù†ØªØ¬ Ø¯Ù‡ Ø¬ÙˆØ¯ØªÙ‡ Ù…Ù…ØªØ§Ø²Ø© ÙˆØ³Ø¹Ø±Ù‡ Ù…Ø¹Ù‚ÙˆÙ„
    Ù‡Ù„ Ø­Ø¶Ø±ØªÙƒ Ø¹Ø§ÙŠØ² ØªØ´ÙˆÙ Ø§Ù„Ø¶Ù…Ø§Ù† ÙƒÙ…Ø§Ù†ØŸ"

Ø§Ù„Ù…ÙˆÙ‚Ù 4: Ø¹Ù…ÙŠÙ„ Ù…Ø³ØªØ¹Ø¬Ù„
âŒ "Ø³ÙˆÙ Ù†Ù‚ÙˆÙ… Ø¨Ù…Ø¹Ø§Ù„Ø¬Ø© Ø·Ù„Ø¨ÙƒÙ… ÙÙŠ Ø£Ù‚Ø±Ø¨ ÙˆÙ‚Øª"
âœ… "ØªÙ…Ø§Ù…ØŒ Ù‡Ø¨Ø¹ØªÙ‡ÙˆÙ„Ùƒ Ø¯Ù„ÙˆÙ‚ØªÙŠ ÙˆÙŠÙˆØµÙ„ Ø¨ÙƒØ±Ù‡ Ø§Ù„ØµØ¨Ø­ Ø¥Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ ğŸšš"

Ø§Ù„Ù…ÙˆÙ‚Ù 5: Ø¹Ù…ÙŠÙ„ Ø¨ÙŠØ³Ø£Ù„ Ù†ÙØ³ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù…Ø±ØªÙŠÙ†
âŒ ØªÙƒØ±Ø§Ø± Ù†ÙØ³ Ø§Ù„Ø±Ø¯ Ø¨Ø§Ù„Ø¶Ø¨Ø·
âœ… ØºÙŠØ±ÙŠ ÙÙŠ Ø§Ù„ØµÙŠØ§ØºØ©:
    Ø£ÙˆÙ„ Ù…Ø±Ø©: "Ø³Ø¹Ø±Ù‡ 299 Ø¬Ù†ÙŠÙ‡"
    ØªØ§Ù†ÙŠ Ù…Ø±Ø©: "Ø¨ 299 Ø¬Ù†ÙŠÙ‡ ÙŠØ§ ÙÙ†Ø¯Ù…"
    ØªØ§Ù„Øª Ù…Ø±Ø©: "Ù‡ÙŠÙƒÙ„ÙÙƒ 299 Ø¬ Ø¨Ø³"

`;
  }

  /**
   * Ø¨Ù†Ø§Ø¡ Ø³ÙŠØ§Ù‚ Ø§Ù„Ø¹Ù…ÙŠÙ„
   */
  buildCustomerContext(profile, history) {
    const isReturning = history && history.length > 0;
    const orderCount = profile?.orderCount || 0;
    const customerName = profile?.name || 'Ø¹Ù…ÙŠÙ„';

    let context = `\n\nğŸ“Š Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„:\n`;
    context += `- Ø§Ù„Ø§Ø³Ù…: ${customerName}\n`;
    
    if (isReturning) {
      context += `- Ø¹Ù…ÙŠÙ„ Ø±Ø§Ø¬Ø¹ (Ø¹Ù†Ø¯Ù‡ ${orderCount} Ø·Ù„Ø¨ Ø³Ø§Ø¨Ù‚) â­\n`;
      context += `- Ø¢Ø®Ø± ØªÙØ§Ø¹Ù„: ${this.getLastInteractionTime(history)}\n`;
    } else {
      context += `- Ø¹Ù…ÙŠÙ„ Ø¬Ø¯ÙŠØ¯ (Ø£ÙˆÙ„ Ù…Ø±Ø©) ğŸ‰\n`;
    }

    // Ø¥Ø¶Ø§ÙØ© Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ø¥Ù† ÙˆØ¬Ø¯Øª
    if (history && history.length > 0) {
      context += `\nğŸ“š Ø¢Ø®Ø± 3 ØªÙØ§Ø¹Ù„Ø§Øª:\n`;
      history.slice(-3).forEach((interaction, index) => {
        context += `${index + 1}. Ø§Ù„Ø¹Ù…ÙŠÙ„: "${interaction.userMessage.substring(0, 50)}..."\n`;
        context += `   Ø±Ø¯Ùƒ: "${interaction.aiResponse.substring(0, 50)}..."\n`;
      });
      context += `ğŸ’¡ Ø§Ø³ØªØ®Ø¯Ù…ÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø³ÙŠØ§Ù‚ Ù„Ù„Ø§Ø³ØªÙ…Ø±Ø§Ø±ÙŠØ©\n`;
    }

    return context;
  }

  /**
   * Ø­Ø³Ø§Ø¨ Ø§Ù„ÙˆÙ‚Øª Ù…Ù†Ø° Ø¢Ø®Ø± ØªÙØ§Ø¹Ù„
   */
  getLastInteractionTime(history) {
    if (!history || history.length === 0) return 'N/A';
    
    const lastInteraction = history[history.length - 1];
    const time = new Date(lastInteraction.timestamp);
    const now = new Date();
    const diffMinutes = Math.floor((now - time) / (1000 * 60));
    
    if (diffMinutes < 5) return 'Ø¯Ù‚Ø§Ø¦Ù‚ Ù‚Ù„ÙŠÙ„Ø©';
    if (diffMinutes < 60) return `${diffMinutes} Ø¯Ù‚ÙŠÙ‚Ø©`;
    
    const diffHours = Math.floor(diffMinutes / 60);
    if (diffHours < 24) return `${diffHours} Ø³Ø§Ø¹Ø©`;
    
    const diffDays = Math.floor(diffHours / 24);
    return `${diffDays} ÙŠÙˆÙ…`;
  }

  /**
   * ØªØ­Ø¯ÙŠØ¯ ÙˆÙ‚Øª Ø§Ù„ÙŠÙˆÙ…
   */
  getTimeOfDay() {
    const hour = new Date().getHours();
    if (hour >= 6 && hour < 12) return 'morning';
    if (hour >= 12 && hour < 17) return 'afternoon';
    if (hour >= 17 && hour < 21) return 'evening';
    return 'night';
  }

  /**
   * ØªØ­Ù„ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ø§Ø·ÙÙŠØ© Ù…Ù† Ø§Ù„Ø±Ø³Ø§Ù„Ø©
   */
  async detectEmotionalState(message) {
    const keywords = {
      angry: ['Ø²Ø¹Ù„Ø§Ù†', 'Ù…Ù†Ø²Ø¹Ø¬', 'ØºØ¶Ø¨Ø§Ù†', 'Ù…Ø´ Ø±Ø§Ø¶ÙŠ', 'Ø³ÙŠØ¡', 'Ù…ØªØ£Ø®Ø±', 'Ù…Ø´ÙƒÙ„Ø©', 'ØºÙ„Ø·'],
      happy: ['Ø±Ø§Ø¦Ø¹', 'Ù…Ù…ØªØ§Ø²', 'Ø¬Ù…ÙŠÙ„', 'Ø´ÙƒØ±Ø§Ù‹', 'ØªÙ…Ø§Ù…', 'Ø­Ù„Ùˆ', 'Ø¬Ø§Ù…Ø¯'],
      confused: ['Ù…Ø´ ÙØ§Ù‡Ù…', 'ØŸØŸ', 'Ø§Ø²Ø§ÙŠ', 'ÙŠØ¹Ù†ÙŠ Ø¥ÙŠÙ‡', 'Ù…Ø­ØªØ§Ø±', 'Ù…Ø´ Ø¹Ø§Ø±Ù'],
      worried: ['Ù‚Ù„Ù‚Ø§Ù†', 'Ø®Ø§ÙŠÙ', 'Ù…ØªØ£ÙƒØ¯', 'Ø¶Ù…Ø§Ù†', 'Ù…Ø¶Ù…ÙˆÙ†', 'Ø£Ù…Ø§Ù†']
    };

    const lowerMessage = message.toLowerCase();
    
    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ù†Ù‚Ø§Ø· Ù„ÙƒÙ„ Ø­Ø§Ù„Ø©
    const scores = {};
    for (const [emotion, words] of Object.entries(keywords)) {
      scores[emotion] = words.filter(word => lowerMessage.includes(word)).length;
    }

    // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø­Ø§Ù„Ø© ØµØ§Ø­Ø¨Ø© Ø£Ø¹Ù„Ù‰ Ù†Ù‚Ø§Ø·
    const maxScore = Math.max(...Object.values(scores));
    if (maxScore === 0) return 'neutral';

    return Object.keys(scores).find(emotion => scores[emotion] === maxScore) || 'neutral';
  }

  /**
   * ØªØ­Ù„ÙŠÙ„ Ø£Ø³Ù„ÙˆØ¨ ÙƒÙ„Ø§Ù… Ø§Ù„Ø¹Ù…ÙŠÙ„
   */
  detectCustomerTone(message) {
    const formalIndicators = ['Ø­Ø¶Ø±ØªÙƒ', 'Ø³ÙŠØ§Ø¯ØªÙƒÙ…', 'ØªÙØ¶Ù„ÙˆØ§', 'Ø£ÙˆØ¯', 'ÙŠØ±Ø¬Ù‰'];
    const casualIndicators = ['Ø§Ø²ÙŠÙƒ', 'Ø§ÙŠÙ‡', 'Ø¹Ø§ÙŠØ²', 'Ø­Ù„Ùˆ', 'ÙƒØ¯Ù‡', 'ÙŠØ¹Ù†ÙŠ'];
    
    const lowerMessage = message.toLowerCase();
    
    const formalScore = formalIndicators.filter(word => lowerMessage.includes(word)).length;
    const casualScore = casualIndicators.filter(word => lowerMessage.includes(word)).length;
    
    if (formalScore > casualScore) return 'formal';
    if (casualScore > formalScore) return 'casual';
    return 'balanced';
  }

  /**
   * ØªØ­Ù„ÙŠÙ„ Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø§Ø³ØªØ¹Ø¬Ø§Ù„
   */
  detectUrgencyLevel(message) {
    const urgentKeywords = ['ÙÙˆØ±ÙŠ', 'Ø³Ø±ÙŠØ¹', 'Ù…Ø³ØªØ¹Ø¬Ù„', 'Ø¶Ø±ÙˆØ±ÙŠ', 'Ø§Ù„Ø¢Ù†', 'Ø¯Ù„ÙˆÙ‚ØªÙŠ', '!!!'];
    const lowerMessage = message.toLowerCase();
    
    return urgentKeywords.some(word => lowerMessage.includes(word)) ? 'high' : 'normal';
  }

  /**
   * ØªØ­Ø¯ÙŠØ¯ Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©
   */
  determineConversationPhase(conversationMemory) {
    if (!conversationMemory || conversationMemory.length === 0) {
      return 'opening';
    } else if (conversationMemory.length < 3) {
      return 'middle';
    } else {
      return 'closing';
    }
  }
}

// Singleton instance
let instance = null;

function getDynamicPromptBuilder() {
  if (!instance) {
    instance = new DynamicPromptBuilder();
  }
  return instance;
}

module.exports = getDynamicPromptBuilder();
module.exports.DynamicPromptBuilder = DynamicPromptBuilder;

